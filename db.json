{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/nextv6/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/nextv6/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/nextv6/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1}],"Cache":[{"_id":"themes/nextv6/.all-contributorsrc","hash":"e32dc4075e304af04b98d0726d489081bea722c0","modified":1569207270000},{"_id":"themes/nextv6/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1569207270000},{"_id":"themes/nextv6/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1569207270000},{"_id":"themes/nextv6/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1569207270000},{"_id":"themes/nextv6/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1569207270000},{"_id":"themes/nextv6/.gitignore","hash":"a18c2e83bb20991b899b58e6aeadcb87dd8aa16e","modified":1569207270000},{"_id":"themes/nextv6/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1569207270000},{"_id":"themes/nextv6/.travis.yml","hash":"3d1dc928c4a97933e64379cfde749dedf62f252c","modified":1569207270000},{"_id":"themes/nextv6/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1569207270000},{"_id":"themes/nextv6/README.md","hash":"b4f780a96b0e5d3737eb93bc00da6de91f042c4b","modified":1569207270000},{"_id":"themes/nextv6/_config.yml","hash":"316642851031932003680a81e79b229b43352a8e","modified":1569291111000},{"_id":"themes/nextv6/bower.json","hash":"09628558259cf990fac43ed1f5ef9edae73f124b","modified":1569207270000},{"_id":"themes/nextv6/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1569207270000},{"_id":"themes/nextv6/gulpfile.coffee","hash":"48d2f9fa88a4210308fc41cc7d3f6d53989f71b7","modified":1569207270000},{"_id":"themes/nextv6/package.json","hash":"c791b45d1e6fde11a1e1e11ba5a6ced1f5ba0fce","modified":1569207270000},{"_id":"source/_posts/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1568884932000},{"_id":"source/_posts/2-部署elk7-2-0.md","hash":"997ac39afb41ecba8d072caf525662af36e3d325","modified":1569292715000},{"_id":"source/_posts/3-k8s遇到的一些问题统计总结.md","hash":"6f81ae17ce7bb2bebd2d71ec65c06a1ccab84fd5","modified":1569292706000},{"_id":"source/_posts/首次搭建hexo博客系统.md","hash":"a61d62f90cbf66f40c09df1ed125554f7a8f8d79","modified":1569292830000},{"_id":"source/categories/index.md","hash":"15f79eea17f5a7d01b6dd45aa91b2c34870a41df","modified":1569291203000},{"_id":"source/tags/index.md","hash":"44040952fee1263c49f2204e254ba23200dfe2cd","modified":1569291216000},{"_id":"themes/nextv6/.github/CODE_OF_CONDUCT.md","hash":"b63696d41f022525e40d7e7870c3785b6bc7536b","modified":1569207270000},{"_id":"themes/nextv6/.github/CONTRIBUTING.md","hash":"a5335a99377069ae76fd993d488bc3eaf48f3a05","modified":1569207270000},{"_id":"themes/nextv6/.github/ISSUE_TEMPLATE.md","hash":"00c25366764e6b9ccb40b877c60dc13b2916bbf7","modified":1569207270000},{"_id":"themes/nextv6/.github/PULL_REQUEST_TEMPLATE.md","hash":"207b7097ac56c6c1fc1493577995db234bc80e21","modified":1569207270000},{"_id":"themes/nextv6/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1569207270000},{"_id":"themes/nextv6/.github/stale.yml","hash":"a782ac925201a8fe07959bba0d7696c7b2b5fd2d","modified":1569207270000},{"_id":"themes/nextv6/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1569207270000},{"_id":"themes/nextv6/docs/ALGOLIA-SEARCH.md","hash":"141e989844d0b5ae2e09fb162a280715afb39b0d","modified":1569207270000},{"_id":"themes/nextv6/docs/AUTHORS.md","hash":"7b24be2891167bdedb9284a682c2344ec63e50b5","modified":1569207270000},{"_id":"themes/nextv6/docs/DATA-FILES.md","hash":"8e1962dd3e1b700169b3ae5bba43992f100651ce","modified":1569207270000},{"_id":"themes/nextv6/docs/INSTALLATION.md","hash":"2bbdd6c1751b2b42ce9b9335da420c6026a483e9","modified":1569207270000},{"_id":"themes/nextv6/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"120750c03ec30ccaa470b113bbe39f3d423c67f0","modified":1569207270000},{"_id":"themes/nextv6/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1569207270000},{"_id":"themes/nextv6/docs/MATH.md","hash":"e6023505dcccaef0b856102543585a13fc6af0b1","modified":1569207270000},{"_id":"themes/nextv6/docs/UPDATE-FROM-5.1.X.md","hash":"ad57c168d12ba01cf144a1ea0627b2ffd1847d3e","modified":1569207270000},{"_id":"themes/nextv6/languages/de.yml","hash":"fb478c5040a4e58a4c1ad5fb52a91e5983d65a3a","modified":1569207270000},{"_id":"themes/nextv6/languages/default.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1569207270000},{"_id":"themes/nextv6/languages/en.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1569207270000},{"_id":"themes/nextv6/languages/fr.yml","hash":"0162a85ae4175e66882a9ead1249fedb89200467","modified":1569207270000},{"_id":"themes/nextv6/languages/id.yml","hash":"e7fb582e117a0785036dcdbb853a6551263d6aa6","modified":1569207270000},{"_id":"themes/nextv6/languages/it.yml","hash":"62ef41d0a9a3816939cb4d93a524e6930ab9c517","modified":1569207270000},{"_id":"themes/nextv6/languages/ja.yml","hash":"e331b15b1fda0f2285d25853f834682ab8dc3c39","modified":1569207270000},{"_id":"themes/nextv6/languages/ko.yml","hash":"fae155018ae0efdf68669b2c7dd3f959c2e45cc9","modified":1569207270000},{"_id":"themes/nextv6/languages/nl.yml","hash":"bb9ce8adfa5ee94bc6b5fac6ad24ba4605d180d3","modified":1569207270000},{"_id":"themes/nextv6/languages/pt-BR.yml","hash":"bfc80c8a363fa2e8dde38ea2bc85cd19e15ab653","modified":1569207270000},{"_id":"themes/nextv6/languages/pt.yml","hash":"3cb51937d13ff12fcce747f972ccb664840a9ef3","modified":1569207270000},{"_id":"themes/nextv6/languages/ru.yml","hash":"db0644e738d2306ac38567aa183ca3e859a3980f","modified":1569207270000},{"_id":"themes/nextv6/languages/tr.yml","hash":"c5f0c20743b1dd52ccb256050b1397d023e6bcd9","modified":1569207270000},{"_id":"themes/nextv6/languages/uk.yml","hash":"1eb59e581568da9a81d6e20541b4ada5fc1c55c0","modified":1569207270000},{"_id":"themes/nextv6/languages/vi.yml","hash":"8da921dd8335dd676efce31bf75fdd4af7ce6448","modified":1569207270000},{"_id":"themes/nextv6/languages/zh-CN.yml","hash":"fbbf3a0b664ae8e927c700b0a813692b94345156","modified":1569207270000},{"_id":"themes/nextv6/languages/zh-HK.yml","hash":"7903b96912c605e630fb695534012501b2fad805","modified":1569207270000},{"_id":"themes/nextv6/languages/zh-TW.yml","hash":"6e6d2cd8f4244cb1b349b94904cb4770935acefd","modified":1569207270000},{"_id":"themes/nextv6/layout/_layout.swig","hash":"3be28a8e6c6f4f6d2595301ee01640876c442c41","modified":1569220256000},{"_id":"themes/nextv6/layout/archive.swig","hash":"2b6450c6b6d2bcbcd123ad9f59922a5e323d77a5","modified":1569207270000},{"_id":"themes/nextv6/layout/category.swig","hash":"5d955284a42f802a48560b4452c80906a5d1da02","modified":1569207270000},{"_id":"themes/nextv6/layout/index.swig","hash":"c2a3896c64e96790edc10426ef586b6186a87f46","modified":1569207270000},{"_id":"themes/nextv6/layout/page.swig","hash":"b94779d2250924d8a4ac98a3d80e2deeb2786d76","modified":1569291825000},{"_id":"themes/nextv6/layout/post.swig","hash":"f74929fd792541916eb25c2addfb35431be071ba","modified":1569207270000},{"_id":"themes/nextv6/layout/schedule.swig","hash":"3268dd3d90d8b0e142cfa1a2ebb23355baeda148","modified":1569207270000},{"_id":"themes/nextv6/layout/tag.swig","hash":"ba402ce8fd55e80b240e019e8d8c48949b194373","modified":1569207270000},{"_id":"themes/nextv6/scripts/merge-configs.js","hash":"33afe97284d34542015d358a720823feeebef120","modified":1569207270000},{"_id":"themes/nextv6/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1569207270000},{"_id":"themes/nextv6/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1569207270000},{"_id":"themes/nextv6/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1569207270000},{"_id":"themes/nextv6/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1569207270000},{"_id":"themes/nextv6/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/docs/ru/DATA-FILES.md","hash":"d6d20f60f77a76c77f8e65d0c9adbd79d0274557","modified":1569207270000},{"_id":"themes/nextv6/docs/ru/INSTALLATION.md","hash":"6c5d69e94961c793da156217ecf1179e868d7ba1","modified":1569207270000},{"_id":"themes/nextv6/docs/ru/README.md","hash":"953deb732e0b3b22c423122a189d6847d908c4b8","modified":1569207270000},{"_id":"themes/nextv6/docs/ru/UPDATE-FROM-5.1.X.md","hash":"b1dd18d9b890b21718883ea1832e7e02a773104a","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"6855402e2ef59aae307e8bd2a990647d3a605eb8","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"a45a791b49954331390d548ac34169d573ea5922","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/CONTRIBUTING.md","hash":"bd2c955d9b7b1b45bd74a4536717d547e03fcde3","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/DATA-FILES.md","hash":"f3eec572a7d83542e2710a7404082014aaa1a5e7","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/INSTALLATION.md","hash":"b19a6e0ae96eb7c756fb5b1ba03934c7f9cbb3c3","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"24cf2618d164440b047bb9396263de83bee5b993","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/MATH.md","hash":"8ac2f5d2a023211d8d8ea626cbf6b8dea67ac201","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/README.md","hash":"15e55eb77616500fa4c64982d6bad9ac17a46e2a","modified":1569207270000},{"_id":"themes/nextv6/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"5da70d7fa0c988a66a469b9795d33d471a4a4433","modified":1569207270000},{"_id":"themes/nextv6/layout/_custom/head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1569207270000},{"_id":"themes/nextv6/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1569207270000},{"_id":"themes/nextv6/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/comments.swig","hash":"dce2938bb54c3cef3319f09f2621b93bc41117a0","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/footer.swig","hash":"ecd10acd3469cecab2289fee839a95177b4343a0","modified":1569220743000},{"_id":"themes/nextv6/layout/_partials/github-banner.swig","hash":"11128d3fbe195d7d105e43cf774a1a70b2c1de24","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/pagination.swig","hash":"dbe321bcf3cf45917cc11a3e3f50d8572bac2c70","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/post-edit.swig","hash":"06dac109504812b63766a80ede9ddacbd42d227d","modified":1569207270000},{"_id":"themes/nextv6/layout/_macro/my-copyright.swig","hash":"86380d5b29f40ab8095b12715c0e5e15f4ce7ab4","modified":1569227194000},{"_id":"themes/nextv6/layout/_macro/post-collapse.swig","hash":"35affac8c523f399e59fcc4d3905e03e4e1ed9aa","modified":1569207270000},{"_id":"themes/nextv6/layout/_macro/post.swig","hash":"e10227b55c72a76411d24fc5bbaf13bcb1215c71","modified":1569229698000},{"_id":"themes/nextv6/layout/_macro/sidebar.swig","hash":"a1ded7ba92354ed55ae20a0b6bcc15bbb4b801c2","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/boostrap.swig","hash":"d01881f8056203c4b6920328db8c2ae8fa662a08","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/commons.swig","hash":"d66bc7ec3cc03f60fcc7d555368a5b9b010f7f11","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/noscript.swig","hash":"edaff4766e0c05fd5c889d9dd32884d376bef9d9","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/vendors.swig","hash":"c4c58ea2bd4cf10372a5e46dbec1b9a2e0e69f0f","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/bookmark.swig","hash":"10b61a8bac671e375916a4d234c120117098a78f","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/copy-code.swig","hash":"01056ad0e5ad73885e02244943544d7b740bc3bb","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/exturl.swig","hash":"d359e638a86bd9664101c48e9344f21ec96e6a15","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/needsharebutton.swig","hash":"2c4a66be4677d3e4dec3f169ac8a769098dad1fe","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/pangu.swig","hash":"c28f9dc96ab735daeb7f599f86470aa5a83c03cf","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/pdf.swig","hash":"5453d76e00bfcd1d732fc5f41828a90eb681f645","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/rating.swig","hash":"cbe40cb67dad15ade967b0f396c1a95b6871f76a","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/schedule.swig","hash":"272c46f03766ea0c169163342bb98f09f561cf4c","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/scroll-cookie.swig","hash":"1b250c1b7945cb1029b9e855edb09854f7c8250a","modified":1569207270000},{"_id":"themes/nextv6/scripts/helpers/engine.js","hash":"60eb1554456d9d0e5afc4a2d16f1580a0aa02da8","modified":1569207270000},{"_id":"themes/nextv6/scripts/helpers/next-url.js","hash":"15582e823d228c0b2288543c1eb460c40afad29b","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/button.js","hash":"4b12c376bea894d23cca0f9fcb3d6518b6db279d","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/center-quote.js","hash":"f13430d9d1c9773b390787c2f046bb1f12a79878","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/exturl.js","hash":"7ded3e7a78380b32de3e12f156e0978ef5c2890a","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/full-image.js","hash":"5f2f4c6e15b3197f26a26926876af70ef6390fc4","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/group-pictures.js","hash":"981e01aaf45a1f0f23ce0796d03134f9e437aaca","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/include-raw.js","hash":"5db59d56f4f4082382bf1c16722e6c383892b0c5","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/label.js","hash":"f0ecd3b5773b19a6bd93a819dfe0c49ee418e4de","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/note.js","hash":"adb945ba93ac487d46b969ca4e59d3681b8f8d1c","modified":1569207270000},{"_id":"themes/nextv6/scripts/tags/tabs.js","hash":"dbc8750a3f6d5676c52bb570d13ac7c51a234f21","modified":1569207270000},{"_id":"themes/nextv6/source/css/main.styl","hash":"c26ca6e7b5bd910b9046d6722c8e00be672890e0","modified":1569207270000},{"_id":"themes/nextv6/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1569207270000},{"_id":"themes/nextv6/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1569207270000},{"_id":"themes/nextv6/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1569207270000},{"_id":"themes/nextv6/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1569207270000},{"_id":"themes/nextv6/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1569207270000},{"_id":"themes/nextv6/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1569207270000},{"_id":"themes/nextv6/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1569207270000},{"_id":"themes/nextv6/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1569207270000},{"_id":"themes/nextv6/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1569207270000},{"_id":"themes/nextv6/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1569207270000},{"_id":"themes/nextv6/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1569207270000},{"_id":"themes/nextv6/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/head/external-fonts.swig","hash":"fc6bafc8c633afadc538c5afa5620ea2a1cdcb84","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/head/head-unique.swig","hash":"dc53a41196b675268bfd2a944f6258c57ed44e91","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/head/head.swig","hash":"6a825ce9412339ec4a128d9714804994cb85522c","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/header/brand.swig","hash":"58e2e153e8b67e643b24453a1e1cceaae3323647","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/header/index.swig","hash":"2082f5077551123e695e8afec471c9c44b436acb","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/header/menu.swig","hash":"3db735d0cd2d449edf2674310ac1e7c0043cb357","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/header/sub-menu.swig","hash":"5adc60100e129c1d0307bdcaa0c7b8e8375a6ea4","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/page/breadcrumb.swig","hash":"69722be16ce5eae5c027168f9b2fded4776e1b53","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/page/page-header.swig","hash":"2940df694fff28e8bf71b6546b4162f1e38227db","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/post/post-copyright.swig","hash":"2f73cc9ffb63534f0b6d8f0e9ee853c1af1b1244","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/post/post-related.swig","hash":"eea95b785c9c36d28e1839619793f66e89773bee","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/post/reward.swig","hash":"64d65d9ad0cc94734ac6ded279e2b5dc870a1cab","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/post/wechat-subscriber.swig","hash":"d63208ee20529450c35de8fe80ef41fffa831dc9","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/search/index.swig","hash":"a33b29ccbdc2248aedff23b04e0627f435824406","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/search/swiftype.swig","hash":"a5587bd1f60d35e58618576cec45e662aa44ea1f","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1569207270000},{"_id":"themes/nextv6/layout/_partials/share/duoshuo_share.swig","hash":"d5bfb363a1154e6505f0cccbd811fa71db133e3d","modified":1569207270000},{"_id":"themes/nextv6/layout/_macro/menu/menu-badge.swig","hash":"65c5e585982dae7ae1542cada71858b4ea1f73d6","modified":1569207270000},{"_id":"themes/nextv6/layout/_macro/menu/menu-item.swig","hash":"fb33f499022cd02722f834fcef1a0e193362cfde","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/pages/post-details.swig","hash":"c7f2855f19dfdf18aba8c58d55b7489e631ed035","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/schemes/gemini.swig","hash":"94e106755c5fb6f40431b621beeba0bd33877e57","modified":1569207270000},{"_id":"themes/nextv6/layout/_scripts/schemes/pisces.swig","hash":"94e106755c5fb6f40431b621beeba0bd33877e57","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/application-insights.swig","hash":"798d67e4a736613ab899eabe6529091bbcda7850","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/baidu-analytics.swig","hash":"591b2ccd9713ccb922b9fcf5e278b6de9c5ec30b","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/busuanzi-counter.swig","hash":"07307f1f0e0e9858f2c7143cbdfcb2a9a92149ab","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/cnzz-analytics.swig","hash":"08cd47ef8572121b7811342d3c9a84a338a18191","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/facebook-sdk.swig","hash":"050ea01f25cfe492be9bb77b409644d623fdf2dc","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/firestore.swig","hash":"fae69a0e1a1d42f7bb44e594a29857d94594698b","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/google-analytics.swig","hash":"529db1ff4b6c18822d6cf77f644a7f7b39c80870","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/growingio.swig","hash":"9e576f12a294b14bd262f59c309a50cbf7003827","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/index.swig","hash":"438c6f5e6665d72f4ea7ee206011d669246f6102","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/lean-analytics.swig","hash":"c28f3f4aa31d7f996d26a97df6cd7ffa9bfd2cec","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/tencent-analytics.swig","hash":"f240a50cd9b627620d9a374a29cf95f0c5e99d7c","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/tencent-mta.swig","hash":"41b4644f7264b16336154ac842f35278e3bb09b8","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/analytics/vkontakte-api.swig","hash":"cbf620cf2a78e3ac736cdd7e768513cfd6946e83","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/changyan.swig","hash":"aea70f5ec17917b75812020d8bf2aeabd434e8bc","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/disqus.swig","hash":"c4c50a646254a186413bb5e4e320af4071a8b072","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/gitalk.swig","hash":"3fee34fc9620195b1152e96f126c516a7175fdbb","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/gitment.swig","hash":"d34e054a6d5c8a5fb4dd4b4671e666891e4c9adf","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/index.swig","hash":"9809d63a4234c5f268ff0b489579149b849728fc","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/livere.swig","hash":"607a60588ad3d226eb0fb50df601e2f2ff6d627c","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/comments/valine.swig","hash":"9eb881107c407d8d9e759d10d247f2ade412c2d9","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/math/index.swig","hash":"a7e304b05a44279d3e4f611908d7faef9dc14d7c","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/math/katex.swig","hash":"c2cb2f384bc30d31cdccf9794a729c03e687b45c","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/math/mathjax.swig","hash":"c76c7ac9b97e74908467701b10e25707ba5c979e","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/search/localsearch.swig","hash":"b3eaab6a269aa3fcbafe24fd06f0c9206dc12716","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/seo/baidu-push.swig","hash":"323ccd05bf8befb7d33de443cf3ac6a4195c3554","modified":1569207270000},{"_id":"themes/nextv6/scripts/filters/after_post_render/exturl.js","hash":"9c9f61b7bfb3349b03b1e61355f20232044b5fd8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_custom/custom.styl","hash":"fc1688e6e09dfd99348b5b31632cde8ad1b450f4","modified":1569208971000},{"_id":"themes/nextv6/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1569207270000},{"_id":"themes/nextv6/source/css/_mixins/Pisces.styl","hash":"2640a54fa63bdd4c547eab7ce2fc1192cf0ccec8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_mixins/base.styl","hash":"086f5979b3de091c3378512e6c5c2f8fcb4f6298","modified":1569207270000},{"_id":"themes/nextv6/source/css/_variables/Gemini.styl","hash":"a8aa41625b94cf17a7f473ed10dcbe683b1db705","modified":1569207270000},{"_id":"themes/nextv6/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1569207270000},{"_id":"themes/nextv6/source/css/_variables/Pisces.styl","hash":"fc15e277d1504532a09b7b1bd31f900ad95ec4b8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_variables/base.styl","hash":"9e56e8b553cac103c9a6f2f615c51754992ec4e1","modified":1569219111000},{"_id":"themes/nextv6/source/js/src/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/bootstrap.js","hash":"1c41508b83cb0c4512e64b4d63afa1be954ce8ef","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/motion.js","hash":"7933a30382a84b655238f6e78d42ea1b99af4de6","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/utils.js","hash":"f1394d64977439ec569d2777b1ac304905e043f1","modified":1569207270000},{"_id":"themes/nextv6/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1568883393000},{"_id":"themes/nextv6/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1569207270000},{"_id":"themes/nextv6/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1569207270000},{"_id":"themes/nextv6/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1569207270000},{"_id":"themes/nextv6/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1569207270000},{"_id":"themes/nextv6/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/search/algolia-search/assets.swig","hash":"cd86bed852fec6e6933898067122a03755bc17f0","modified":1569207270000},{"_id":"themes/nextv6/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/back-to-top-sidebar.styl","hash":"837ff3718cb5a63eb01a451e35989fd1dfe4218c","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/scaffolding/base.styl","hash":"d33420ef9a655ecaa1c70af6d9bfed0740d8a5bf","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/scaffolding/mobile.styl","hash":"efc40a32487e0ac7b94b1ca81bdbdcc4ec8f2924","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/scaffolding/tables.styl","hash":"02d138ed65060e98f20bc5b1dd59a791222b7156","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/outline/outline.styl","hash":"513779f38d94a98511db14fe4527cdc453f426b8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Gemini/index.styl","hash":"8dfd4d744e664a97df7a96d045bcfde282ab2dff","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/_base.styl","hash":"0bef9f0dc134215bc4d0984ba3a16a1a0b6f87ec","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/_menu.styl","hash":"fe2dc74726a515549956d233becda188da64f948","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/_posts-expanded.styl","hash":"09ddd5a0388bee97e688ec07ece8429ca4fbba1e","modified":1569219494000},{"_id":"themes/nextv6/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/index.styl","hash":"420dcea83a61b2e51d0b91b86fc49f84ecf06bcf","modified":1569208360000},{"_id":"themes/nextv6/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Muse/_logo.styl","hash":"fc160583f742c94316a0fee05c18468033173534","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Muse/_menu.styl","hash":"936132428a0d35b3947ccedd4c379940abcf223a","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Muse/index.styl","hash":"d5e8ea6336bc2e237d501ed0d5bbcbbfe296c832","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/_brand.styl","hash":"09b5054ae34ba83c0d614821e574da265af55a14","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/_layout.styl","hash":"9b076c92abdadcf9acee75da64592ff3badd69b8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/_menu.styl","hash":"74c7dccf0a3ee9fc2ca25ad8e998243191813a0e","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/_sidebar.styl","hash":"e7afdb343f9502f433f49044e42fe347719ce330","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5b936dddb7b4de4720cd1e8428b30a2f06d63fb","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Pisces/index.styl","hash":"5779cc8086b1cfde9bc4f1afdd85223bdc45f0a0","modified":1569207270000},{"_id":"themes/nextv6/source/js/src/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1569207270000},{"_id":"themes/nextv6/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1569207270000},{"_id":"themes/nextv6/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1569207270000},{"_id":"themes/nextv6/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/footer/footer.styl","hash":"39dee82d481dd9d44e33658960ec63e47cd0a715","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/header/github-banner.styl","hash":"ee37e6c465b9b2a7e39175fccfcbed14f2db039b","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/header/header.styl","hash":"7cc3f36222494c9a1325c5347d7eb9ae53755a32","modified":1569218823000},{"_id":"themes/nextv6/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/header/menu.styl","hash":"05e68adae13f4d99a6ac6493daab39c92e39a6bd","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/header/site-meta.styl","hash":"c0d9e18a9210fdcaf33e488518b3b288eb58c0a1","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/highlight/highlight.styl","hash":"2dfa5fde3df69fba8282627e592fe637c2cbac6b","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pages/archive.styl","hash":"6904fd7ea6455e008d9884558b68254608af9a3c","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pages/breadcrumb.styl","hash":"7dd9a0378ccff3e4a2003f486b1a34e74c20dac6","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pages/pages.styl","hash":"fb451dc4cc0355b57849c27d3eb110c73562f794","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/pages/schedule.styl","hash":"f2911a048e5c20ca2a059bd1087d98ac1c51681c","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/my-post-copyright.styl","hash":"e3f0a29751c4253e2baaf0409ed6d669b0de0693","modified":1569229538000},{"_id":"themes/nextv6/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-collapse.styl","hash":"4c9839e7d973861abd862e17538ba3b03fb4510e","modified":1569219780000},{"_id":"themes/nextv6/source/css/_common/components/post/post-copyright.styl","hash":"2356226157e8068b0e9bbe2f7d0f74e1ab49199b","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-expand.styl","hash":"ca89b167d368eac50a4f808fa53ba67e69cbef94","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-meta.styl","hash":"417f05ff12a2aaca6ceeac8b7e7eb26e9440c4c3","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-nav.styl","hash":"1cf64afd4b49143972f7617869539be3adb91a5e","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-reading_progress.styl","hash":"f4e9f870baa56eae423a123062f00e24cc780be1","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-reward.styl","hash":"5f964ef8a38b9901ac8f87e3f5c93e0c44ec947a","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-title.styl","hash":"39beaf3ab19b52e4400bf833eb6e03bf36020ff5","modified":1569208103000},{"_id":"themes/nextv6/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post-widgets.styl","hash":"578bb2d5f24cad39205bbafb4c39c7e9962b9fa9","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/post/post.styl","hash":"1eca48fc0e14c44afb1e492d16d50a6129ad2046","modified":1569227823000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"35c0350096921dd8e2222ec41b6c17a4ea6b44f2","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-author.styl","hash":"e18b90c97aaff027e795f5a0cb10476a71bf1c3a","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"b34bb2ea4d16e47e6fdc06cd4feb32d93ccbd779","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"4427ed3250483ed5b7baad74fa93474bd1eda729","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/sidebar.styl","hash":"43bc58daa8d35d5d515dc787ceb21dd77633fe49","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/full-image.styl","hash":"6ec8ea7b11a146777b6b8da0f71f0cc1dbd129df","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/tags/tags.styl","hash":"5e340ee2407a4e39cd708794cfcc718a5f398d7b","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/algolia-search.styl","hash":"090018c4467a5cc056bdceebd2517a87e3cb7835","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/gitalk.styl","hash":"ac7753d536341aa824d7bce0332735e838916995","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/han.styl","hash":"6157665b8fc26ce4635c926128ffbd831a2fdd46","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/related-posts.styl","hash":"76937db9702053d772f6758d9cea4088c2a6e2a3","modified":1569207270000},{"_id":"themes/nextv6/source/css/_common/components/third-party/third-party.styl","hash":"d4fefad868498adff03321b9dc38e75c61e08def","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1569207270000},{"_id":"themes/nextv6/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1569207270000},{"_id":"themes/nextv6/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1569207270000},{"_id":"public/search.xml","hash":"3fb75aa60fe07eb096e9cdbe0248a159ef89a36d","modified":1569292844260},{"_id":"public/categories/index.html","hash":"d23b858c57b4f19e295df136e577ef725a94540e","modified":1569292844275},{"_id":"public/tags/index.html","hash":"a23a192f1e949815520adeaf7455ca70aa672f57","modified":1569292844275},{"_id":"public/2019/09/20/3-k8s遇到的一些问题统计总结/index.html","hash":"c2585740dd9e56e6ad8d2c2f333c16dd2525275e","modified":1569292844276},{"_id":"public/2019/09/19/2-部署elk7-2-0/index.html","hash":"d055871055c25dc98ddaae56370e129ce3a55455","modified":1569292844276},{"_id":"public/2019/09/19/首次搭建hexo博客系统/index.html","hash":"d124acfe20510d0a94e6e93fa5a33f5ff6fd66f9","modified":1569292844276},{"_id":"public/archives/index.html","hash":"8c9803636dc133cdd0633bf6a989d6928ba211c2","modified":1569292844276},{"_id":"public/categories/技术文档/index.html","hash":"41a07e29a8287e92ea1b92d3f8ad3376567f6d2e","modified":1569292844277},{"_id":"public/categories/技术文档/k8s/index.html","hash":"cb608f0526f006c93ba62d2016d58aac4087b61c","modified":1569292844277},{"_id":"public/categories/技术文档/elk/index.html","hash":"6c06637ac714d602ae46daaa984481cbd68d34a3","modified":1569292844277},{"_id":"public/categories/技术文档/博客/index.html","hash":"54c39279f0761586df5f9413a23c804bad5d410a","modified":1569292844277},{"_id":"public/index.html","hash":"108ebb3aa70c9d92e6a18ebf5ee94c541f1e3aeb","modified":1569292844277},{"_id":"public/tags/k8s/index.html","hash":"e05a2aaae01b6b9da738e489ab76eb1f733e4bc2","modified":1569292844278},{"_id":"public/tags/elk/index.html","hash":"150d91dbfe87226c836f18bad90c97866263dc6f","modified":1569292844278},{"_id":"public/tags/elk7/index.html","hash":"05a63d36da4baa37bfee8038b72d5e6e1e37d80c","modified":1569292844278},{"_id":"public/tags/hexo6/index.html","hash":"ca7492608b8c1c1d6ed9a31660a67e7c4a7397de","modified":1569292844278},{"_id":"public/tags/hexo美化/index.html","hash":"5aa00f338084fd5582f0ad94a067e1120d88a187","modified":1569292844278},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1569292844283},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1569292844283},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1569292844283},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1569292844283},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1569292844284},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1569292844284},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1569292844284},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1569292844284},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1569292844284},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1569292844284},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1569292844284},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1569292844284},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1569292844284},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1569292844284},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1569292844284},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1569292844284},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1569292844284},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1569292844284},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1569292844284},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1569292844284},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1569292845043},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1569292845045},{"_id":"public/js/src/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1569292845049},{"_id":"public/js/src/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1569292845049},{"_id":"public/js/src/bootstrap.js","hash":"1c41508b83cb0c4512e64b4d63afa1be954ce8ef","modified":1569292845049},{"_id":"public/js/src/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1569292845049},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1569292845050},{"_id":"public/js/src/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1569292845050},{"_id":"public/js/src/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1569292845050},{"_id":"public/js/src/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1569292845050},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1569292845050},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1569292845050},{"_id":"public/js/src/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1569292845050},{"_id":"public/css/main.css","hash":"2478884446125b831b01b1c7ccf7249bc2060416","modified":1569292845050},{"_id":"public/js/src/motion.js","hash":"7933a30382a84b655238f6e78d42ea1b99af4de6","modified":1569292845052},{"_id":"public/js/src/utils.js","hash":"f1394d64977439ec569d2777b1ac304905e043f1","modified":1569292845053},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1569292845053},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1569292845053},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1569292845053},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1569292845053},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1569292845058},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1569292845067},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1569292845067},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1569292845067},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1569292845078},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1569292845083}],"Category":[{"name":"技术文档","_id":"ck0x8fsrq00037g9kacshh95g"},{"name":"k8s","parent":"ck0x8fsrq00037g9kacshh95g","_id":"ck0x8fsrt00067g9k8y85f9dv"},{"name":"elk","parent":"ck0x8fsrq00037g9kacshh95g","_id":"ck0x8fst5000c7g9kvyfzbq25"},{"name":"博客","parent":"ck0x8fsrq00037g9kacshh95g","_id":"ck0x8fst6000e7g9kz756trhm"}],"Data":[],"Page":[{"title":"categories","date":"2019-09-24T02:09:55.000Z","type":"categories","layout":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-09-24 10:09:55\ntype: \"categories\"\nlayout: \"categories\"\ncomments: false\n---\n","updated":"2019-09-24T02:13:23.000Z","path":"categories/index.html","_id":"ck0x8fsrg00017g9kr75117ew","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"title":"tags","date":"2019-09-24T02:08:59.000Z","type":"tags","layout":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2019-09-24 10:08:59\ntype: \"tags\"\nlayout: \"tags\"\ncomments: false\n---\n","updated":"2019-09-24T02:13:36.000Z","path":"tags/index.html","_id":"ck0x8fsrn00027g9ki1ssd4sp","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""}],"Post":[{"title":"k8s遇到的一些问题统计总结","date":"2019-09-20T01:20:39.000Z","copyright":true,"top":10,"_content":"### 1. 单机版k8s pod一直是pending的问题\n> describe一下pod会发现错误: 1 node(s) had taints that the pod didn't tolerate.\n> 这是因为master上存在污点,pod不会再改节点上创建\n> 两种办法:\n\n <!-- more -->\n\n- deploy 的时候加上 容忍该污点\n- 直接取消master上的污点 \n\n```\n# 取消master上污点\n  kubectl taint nodes --all node-role.kubernetes.io/master-\n\n# 查看taint\nkubectl describe node node1\n```\n\n### 2. 修改service-node-port-range\n\n> 由于traefik部署需要对外开放80端口, 但默认仅允许30000以上端口\n\n```\n# kubeadm 1.14 配置\napiServer:\n  extraArgs:\n    authorization-mode: Node,RBAC\n    service-node-port-range: 79-33000\n\n# kubeadm 1.10配置\napiServerExtraArgs:\n  service-node-port-range: 79-33000\n```\n","source":"_posts/3-k8s遇到的一些问题统计总结.md","raw":"---\ntitle: k8s遇到的一些问题统计总结\ndate: 2019-09-20 09:20:39\ncopyright: true\ntags:\n  - k8s\ncategories:\n  - 技术文档\n  - k8s\ntop: 10\n---\n### 1. 单机版k8s pod一直是pending的问题\n> describe一下pod会发现错误: 1 node(s) had taints that the pod didn't tolerate.\n> 这是因为master上存在污点,pod不会再改节点上创建\n> 两种办法:\n\n <!-- more -->\n\n- deploy 的时候加上 容忍该污点\n- 直接取消master上的污点 \n\n```\n# 取消master上污点\n  kubectl taint nodes --all node-role.kubernetes.io/master-\n\n# 查看taint\nkubectl describe node node1\n```\n\n### 2. 修改service-node-port-range\n\n> 由于traefik部署需要对外开放80端口, 但默认仅允许30000以上端口\n\n```\n# kubeadm 1.14 配置\napiServer:\n  extraArgs:\n    authorization-mode: Node,RBAC\n    service-node-port-range: 79-33000\n\n# kubeadm 1.10配置\napiServerExtraArgs:\n  service-node-port-range: 79-33000\n```\n","slug":"3-k8s遇到的一些问题统计总结","published":1,"updated":"2019-09-24T02:38:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck0x8fsrb00007g9kl1wrzdcu","content":"<h3 id=\"1-单机版k8s-pod一直是pending的问题\"><a href=\"#1-单机版k8s-pod一直是pending的问题\" class=\"headerlink\" title=\"1. 单机版k8s pod一直是pending的问题\"></a>1. 单机版k8s pod一直是pending的问题</h3><blockquote>\n<p>describe一下pod会发现错误: 1 node(s) had taints that the pod didn’t tolerate.<br>这是因为master上存在污点,pod不会再改节点上创建<br>两种办法:</p>\n</blockquote>\n <a id=\"more\"></a>\n\n<ul>\n<li>deploy 的时候加上 容忍该污点</li>\n<li>直接取消master上的污点 </li>\n</ul>\n<figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 取消master上污点</span></span><br><span class=\"line\">  kubectl taint nodes --all <span class=\"keyword\">node</span><span class=\"title\">-role</span>.kubernetes.io/<span class=\"literal\">master</span>-</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看taint</span></span><br><span class=\"line\">kubectl describe <span class=\"keyword\">node</span> <span class=\"title\">node1</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-修改service-node-port-range\"><a href=\"#2-修改service-node-port-range\" class=\"headerlink\" title=\"2. 修改service-node-port-range\"></a>2. 修改service-node-port-range</h3><blockquote>\n<p>由于traefik部署需要对外开放80端口, 但默认仅允许30000以上端口</p>\n</blockquote>\n<figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># kubeadm 1.14 配置</span></span><br><span class=\"line\">apiServer:</span><br><span class=\"line\">  extraArgs:</span><br><span class=\"line\">    authorization-mode: <span class=\"keyword\">Node</span><span class=\"title\">,RBAC</span></span><br><span class=\"line\">    service-<span class=\"keyword\">node</span>-port-range:<span class=\"title\"> 79-33000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># kubeadm 1.10配置</span></span><br><span class=\"line\">apiServerExtraArgs:</span><br><span class=\"line\">  service-<span class=\"keyword\">node</span>-port-range:<span class=\"title\"> 79-33000</span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"length":530,"excerpt":"<h3 id=\"1-单机版k8s-pod一直是pending的问题\"><a href=\"#1-单机版k8s-pod一直是pending的问题\" class=\"headerlink\" title=\"1. 单机版k8s pod一直是pending的问题\"></a>1. 单机版k8s pod一直是pending的问题</h3><blockquote>\n<p>describe一下pod会发现错误: 1 node(s) had taints that the pod didn’t tolerate.<br>这是因为master上存在污点,pod不会再改节点上创建<br>两种办法:</p>\n</blockquote>","more":"<ul>\n<li>deploy 的时候加上 容忍该污点</li>\n<li>直接取消master上的污点 </li>\n</ul>\n<figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 取消master上污点</span></span><br><span class=\"line\">  kubectl taint nodes --all <span class=\"keyword\">node</span><span class=\"title\">-role</span>.kubernetes.io/<span class=\"literal\">master</span>-</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看taint</span></span><br><span class=\"line\">kubectl describe <span class=\"keyword\">node</span> <span class=\"title\">node1</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-修改service-node-port-range\"><a href=\"#2-修改service-node-port-range\" class=\"headerlink\" title=\"2. 修改service-node-port-range\"></a>2. 修改service-node-port-range</h3><blockquote>\n<p>由于traefik部署需要对外开放80端口, 但默认仅允许30000以上端口</p>\n</blockquote>\n<figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># kubeadm 1.14 配置</span></span><br><span class=\"line\">apiServer:</span><br><span class=\"line\">  extraArgs:</span><br><span class=\"line\">    authorization-mode: <span class=\"keyword\">Node</span><span class=\"title\">,RBAC</span></span><br><span class=\"line\">    service-<span class=\"keyword\">node</span>-port-range:<span class=\"title\"> 79-33000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># kubeadm 1.10配置</span></span><br><span class=\"line\">apiServerExtraArgs:</span><br><span class=\"line\">  service-<span class=\"keyword\">node</span>-port-range:<span class=\"title\"> 79-33000</span></span><br></pre></td></tr></table></figure>"},{"title":"部署elk7.2.0","date":"2019-09-19T09:59:53.000Z","copyright":true,"_content":"\n\n> 说明:\n```\n1 单台k8s,本机目录挂载(未配置cephfs)\n2 如果replicas大于1, 就会出现多个es挂载同一个目录,会出现报错(uuid block)\n```\n\n <!-- more -->\n\n### 1. es配置本地挂载 k8s-es-7.2.0.yml\n```\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch7-admin\n namespace: ns-elastic7\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n name: elasticsearch7-admin\n labels:\n   app: elasticsearch\nroleRef:\n apiGroup: rbac.authorization.k8s.io\n kind: ClusterRole\n name: cluster-admin\nsubjects:\n - kind: ServiceAccount\n   name: elasticsearch7-admin\n   namespace: ns-elastic7\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  labels:\n    app: elasticsearch\n    role: master\n  name: elasticsearch-master\n  namespace: ns-elastic7\nspec:\n  replicas: 1\n  serviceName: elasticsearch-master\n  selector:\n    matchLabels:\n      app: elasticsearch\n      role: master\n  template:\n    metadata:\n      labels:\n        app: elasticsearch\n        role: master\n    spec:\n      serviceAccountName: elasticsearch7-admin\n      restartPolicy: Always\n      securityContext:\n        fsGroup: 1000\n      containers:\n        - name: elasticsearch-master\n          image: hub.boqii.com/bq/elasticsearch:7.2.0\n          command: [\"bash\", \"-c\", \"ulimit -l unlimited && sysctl -w vm.max_map_count=262144 && chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data && exec su elasticsearch docker-entrypoint.sh\"]\n          imagePullPolicy: IfNotPresent\n          securityContext:\n            privileged: true\n          ports:\n            - containerPort: 9200\n              protocol: TCP\n            - containerPort: 9300\n              protocol: TCP\n          resources:\n            requests:\n              cpu: \"50m\"\n            limits:\n              cpu: \"800m\"\n          env:\n            - name: cluster.name\n              value: \"es_cluster\"\n            - name: node.master\n              value: \"true\"\n            - name: node.data\n              value: \"true\"\n            - name: cluster.initial_master_nodes\n              value: \"elasticsearch-master-0\" # 根据副本数和name配置\n            - name: discovery.zen.ping_timeout\n              value: \"5s\"\n            - name: node.ingest\n              value: \"false\"\n            - name: ES_JAVA_OPTS\n              value: \"-Xms1g -Xmx1g\"\n            - name: \"discovery.zen.ping.unicast.hosts\"\n              value: \"elasticsearch-discovery\" # Disvocery Service\n            - name: \"http.cors.enabled\"\n              value: \"true\"\n            - name: \"http.cors.allow-origin\"\n              value: \"*\"\n          volumeMounts:\n            - name: elasticsearch-data-volume\n              mountPath: /usr/share/elasticsearch/data\n      volumes:\n        - name: elasticsearch-data-volume\n          hostPath:\n            path: /data/k8s-container/elk-7.2.0/es-7.2.0/data\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: elasticsearch\n  name: elasticsearch-discovery\n  namespace: ns-elastic7\nspec:\n  publishNotReadyAddresses: true\n  ports:\n  - name: transport\n    port: 9300\n    targetPort: 9300\n  selector:\n    app: elasticsearch\n    role: master\n---\nkind: Service\napiVersion: v1\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch-service\n namespace: ns-elastic7\nspec:\n type: NodePort\n ports:\n   - port: 9200\n     targetPort: 9200\n     nodePort: 19230\n     protocol: TCP\n selector:\n   app: elasticsearch\n```\n\n### 2. es配置nfs动态挂载 k8s-es-7.2.0-nfs.yml\n```\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch-admin\n namespace: ns-elastic\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n name: elasticsearch-admin\n labels:\n   app: elasticsearch\nroleRef:\n apiGroup: rbac.authorization.k8s.io\n kind: ClusterRole\n name: cluster-admin\nsubjects:\n - kind: ServiceAccount\n   name: elasticsearch-admin\n   namespace: ns-elastic\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  labels:\n    app: elasticsearch\n    role: master\n  name: elasticsearch-master\n  namespace: ns-elastic\nspec:\n  replicas: 2\n  volumeClaimTemplates:\n  - metadata:\n      name: elasticsearch-data-nfs\n      annotations:\n        volume.beta.kubernetes.io/storage-class: \"nfs\"\n    spec:\n      accessModes: [ \"ReadWriteOnce\" ]\n      resources:\n        requests:\n          storage: 2Gi\n  serviceName: elasticsearch-master\n  selector:\n    matchLabels:\n      app: elasticsearch\n      role: master\n  template:\n    metadata:\n      labels:\n        app: elasticsearch\n        role: master\n    spec:\n      serviceAccountName: elasticsearch-admin\n      restartPolicy: Always\n      securityContext:\n        fsGroup: 1000\n      containers:\n        - name: elasticsearch-master\n          image: elasticsearch:7.2.0\n          command: [\"bash\", \"-c\", \"ulimit -l unlimited && sysctl -w vm.max_map_count=262144 && chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data && exec su elasticsearch docker-entrypoint.sh\"]\n          imagePullPolicy: IfNotPresent\n          volumeMounts:\n          - name: elasticsearch-data-nfs\n            mountPath: /usr/share/elasticsearch/data\n          securityContext:\n            privileged: true\n          ports:\n            - containerPort: 9200\n              protocol: TCP\n            - containerPort: 9300\n              protocol: TCP\n          env:\n            - name: cluster.name\n              value: \"es_cluster\"\n            - name: node.master\n              value: \"true\"\n            - name: node.data\n              value: \"true\"\n            - name: cluster.initial_master_nodes\n              value: \"elasticsearch-master-0,elasticsearch-master-1\" # 根据副本数和name配置\n            - name: discovery.zen.ping_timeout\n              value: \"5s\"\n            - name: node.ingest\n              value: \"false\"\n            - name: ES_JAVA_OPTS\n              value: \"-Xms1g -Xmx1g\"\n            - name: \"discovery.zen.ping.unicast.hosts\"\n              value: \"elasticsearch-discovery\" # Disvocery Service\n            - name: \"http.cors.enabled\"\n              value: \"true\"\n            - name: \"http.cors.allow-origin\"\n              value: \"*\"\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: elasticsearch\n  name: elasticsearch-discovery\n  namespace: ns-elastic\nspec:\n  publishNotReadyAddresses: true\n  ports:\n  - name: transport\n    port: 9300\n    targetPort: 9300\n  selector:\n    app: elasticsearch\n    role: master\n---\nkind: Service\napiVersion: v1\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch-service\n namespace: ns-elastic\nspec:\n type: NodePort\n ports:\n   - port: 9200\n     targetPort: 9200\n     nodePort: 19220\n     protocol: TCP\n selector:\n   app: elasticsearch\n```\n\n\n### 3. kibana配置k8s-kibana-7.2.0.yml\n```\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: kibana-config\n  namespace: ns-elastic7\n  labels:\n    elastic-app: kibana\ndata:\n  kibana.yml: |\n    server.name: kibana\n    server.host: \"0\"\n    elasticsearch.hosts: [ \"http://elasticsearch-service:9200\" ]\n    xpack.monitoring.ui.container.elasticsearch.enabled: true\n---\nkind: Deployment\napiVersion: apps/v1beta2\nmetadata:\n  labels:\n    elastic-app: kibana\n  name: kibana\n  namespace: ns-elastic7\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      elastic-app: kibana\n  template:\n    metadata:\n      labels:\n        elastic-app: kibana\n    spec:\n      containers:\n        - name: kibana\n          image: hub.boqii.com/bq/kibana:7.2.0\n          ports:\n            - containerPort: 5601\n              protocol: TCP\n          resources:\n            requests:\n              cpu: \"50m\"\n            limits:\n              cpu: \"800m\"\n          volumeMounts:\n            - name: kibana-config\n              mountPath: /usr/share/kibana/config\n      volumes:\n        - name: kibana-config\n          configMap:\n            name: kibana-config\n      tolerations:\n        - key: node-role.kubernetes.io/master\n          effect: NoSchedule\n\n---\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    elastic-app: kibana\n  name: kibana-service\n  namespace: ns-elastic7\nspec:\n  ports:\n    - port: 5601\n      targetPort: 5601\n  selector:\n    elastic-app: kibana\n  type: NodePort\n---\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n labels:\n   elastic-app: kibana\n name: kibana-ingress\n namespace: ns-elastic7\nspec:\n rules:\n   - host: elk-kibana-dev.boqii.com\n     http:\n       paths:\n         - backend:\n             serviceName: kibana-service\n             servicePort: 5601\n```\n\n### 4. logstash配置 本地挂载 k8s-logstash-7.2.0.yml\n- 4.1 config/pipelines.yml\n```\n- pipeline.id: main\n  path.config: \"/usr/share/logstash/config/pipeline/*.conf\"\n```\n\n- 4.2 首先配置grok规则 config/pipeline/logstash.conf\n```\ninput {\n    udp {\n        port => \"10000\"\n        }\n    }\n\n filter {\n      grok {\n          match => {\n            \"message\" => \"\\{\\\"id\\\":\\\"(?<id>(.)*)\\\",\\\"tag\\\":\\\"(?<tag>(.)*)\\\",\\\"title\\\":\\\"%{GREEDYDATA:title}(?<title>(.|\\r|\\n)*)\\\",\\\"value\\\":\\\"%{GREEDYDATA:value}(?<value>(.|\\r|\\n)*)\\\",\\\"createdAt\\\":\\\"(?<createdAt>\\S+ \\S+)\\\",\\\"Telephone\\\":\\\"(?<Telephone>(.)*)\\\",\\\"uid\\\":\\\"(?<uid>(.)*)\\\",\\\"updateTime\\\":\\\"(?<updateTime>(.)*)\\\",\\\"appVersion\\\":\\\"(?<appVersion>(.)*)\\\",\\\"mobileModel\\\":\\\"(?<mobileModel>(.)*)\\\",\\\"osVersion\\\":\\\"(?<osVersion>(.)*)\\\",\\\"channel\\\":\\\"(?<channel>(.)*)\\\",\\\"UDID\\\":\\\"(?<UDID>(.)*)\\\"\\}\"\n              }\n            }\n }\n\noutput {\n    elasticsearch {\n        hosts =>  [ \"http://elasticsearch-service:9200\" ]\n        index => \"k8s2-dev-%{+YYYY.MM.dd}\"\n\n        }\n\n    }\n```\n\n- 4.3 配置文件 k8s-logstash-7.2.0.yml\n```\n---\nkind: Deployment\napiVersion: apps/v1beta2\nmetadata:\n  labels:\n    elastic-app: logstash\n  name: logstash\n  namespace: ns-elastic\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      elastic-app: logstash\n  template:\n    metadata:\n      labels:\n        elastic-app: logstash\n    spec:\n      containers:\n        - name: logstash\n          image: hub.boqii.com/bq/logstash:7.2.0\n          ports:\n            - containerPort: 10000\n              protocol: UDP\n          volumeMounts:\n            - name: logstash-config\n              mountPath: /usr/share/logstash/config\n      volumes:\n        - name: logstash-config\n          hostPath:\n            path: /data/k8s-pod/elk-7.2.0/logstash-7.2.0/config\n      tolerations:\n        - key: node-role.kubernetes.io/master\n          effect: NoSchedule\n\n---\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    elastic-app: logstash\n  name: logstash-service\n  namespace: ns-elastic\nspec:\n  type: NodePort\n  ports:\n    - port: 10000\n      targetPort: 10000\n      nodePort: 10000\n      protocol: UDP\n  selector:\n    elastic-app: logstash\n  type: NodePort\n---\n```\n","source":"_posts/2-部署elk7-2-0.md","raw":"---\ntitle: 部署elk7.2.0\ndate: 2019-09-19 17:59:53\ncopyright: true\ntags:\n  - k8s\n  - elk\n  - elk7\ncategories:\n  - 技术文档\n  - elk\n---\n\n\n> 说明:\n```\n1 单台k8s,本机目录挂载(未配置cephfs)\n2 如果replicas大于1, 就会出现多个es挂载同一个目录,会出现报错(uuid block)\n```\n\n <!-- more -->\n\n### 1. es配置本地挂载 k8s-es-7.2.0.yml\n```\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch7-admin\n namespace: ns-elastic7\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n name: elasticsearch7-admin\n labels:\n   app: elasticsearch\nroleRef:\n apiGroup: rbac.authorization.k8s.io\n kind: ClusterRole\n name: cluster-admin\nsubjects:\n - kind: ServiceAccount\n   name: elasticsearch7-admin\n   namespace: ns-elastic7\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  labels:\n    app: elasticsearch\n    role: master\n  name: elasticsearch-master\n  namespace: ns-elastic7\nspec:\n  replicas: 1\n  serviceName: elasticsearch-master\n  selector:\n    matchLabels:\n      app: elasticsearch\n      role: master\n  template:\n    metadata:\n      labels:\n        app: elasticsearch\n        role: master\n    spec:\n      serviceAccountName: elasticsearch7-admin\n      restartPolicy: Always\n      securityContext:\n        fsGroup: 1000\n      containers:\n        - name: elasticsearch-master\n          image: hub.boqii.com/bq/elasticsearch:7.2.0\n          command: [\"bash\", \"-c\", \"ulimit -l unlimited && sysctl -w vm.max_map_count=262144 && chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data && exec su elasticsearch docker-entrypoint.sh\"]\n          imagePullPolicy: IfNotPresent\n          securityContext:\n            privileged: true\n          ports:\n            - containerPort: 9200\n              protocol: TCP\n            - containerPort: 9300\n              protocol: TCP\n          resources:\n            requests:\n              cpu: \"50m\"\n            limits:\n              cpu: \"800m\"\n          env:\n            - name: cluster.name\n              value: \"es_cluster\"\n            - name: node.master\n              value: \"true\"\n            - name: node.data\n              value: \"true\"\n            - name: cluster.initial_master_nodes\n              value: \"elasticsearch-master-0\" # 根据副本数和name配置\n            - name: discovery.zen.ping_timeout\n              value: \"5s\"\n            - name: node.ingest\n              value: \"false\"\n            - name: ES_JAVA_OPTS\n              value: \"-Xms1g -Xmx1g\"\n            - name: \"discovery.zen.ping.unicast.hosts\"\n              value: \"elasticsearch-discovery\" # Disvocery Service\n            - name: \"http.cors.enabled\"\n              value: \"true\"\n            - name: \"http.cors.allow-origin\"\n              value: \"*\"\n          volumeMounts:\n            - name: elasticsearch-data-volume\n              mountPath: /usr/share/elasticsearch/data\n      volumes:\n        - name: elasticsearch-data-volume\n          hostPath:\n            path: /data/k8s-container/elk-7.2.0/es-7.2.0/data\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: elasticsearch\n  name: elasticsearch-discovery\n  namespace: ns-elastic7\nspec:\n  publishNotReadyAddresses: true\n  ports:\n  - name: transport\n    port: 9300\n    targetPort: 9300\n  selector:\n    app: elasticsearch\n    role: master\n---\nkind: Service\napiVersion: v1\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch-service\n namespace: ns-elastic7\nspec:\n type: NodePort\n ports:\n   - port: 9200\n     targetPort: 9200\n     nodePort: 19230\n     protocol: TCP\n selector:\n   app: elasticsearch\n```\n\n### 2. es配置nfs动态挂载 k8s-es-7.2.0-nfs.yml\n```\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch-admin\n namespace: ns-elastic\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n name: elasticsearch-admin\n labels:\n   app: elasticsearch\nroleRef:\n apiGroup: rbac.authorization.k8s.io\n kind: ClusterRole\n name: cluster-admin\nsubjects:\n - kind: ServiceAccount\n   name: elasticsearch-admin\n   namespace: ns-elastic\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  labels:\n    app: elasticsearch\n    role: master\n  name: elasticsearch-master\n  namespace: ns-elastic\nspec:\n  replicas: 2\n  volumeClaimTemplates:\n  - metadata:\n      name: elasticsearch-data-nfs\n      annotations:\n        volume.beta.kubernetes.io/storage-class: \"nfs\"\n    spec:\n      accessModes: [ \"ReadWriteOnce\" ]\n      resources:\n        requests:\n          storage: 2Gi\n  serviceName: elasticsearch-master\n  selector:\n    matchLabels:\n      app: elasticsearch\n      role: master\n  template:\n    metadata:\n      labels:\n        app: elasticsearch\n        role: master\n    spec:\n      serviceAccountName: elasticsearch-admin\n      restartPolicy: Always\n      securityContext:\n        fsGroup: 1000\n      containers:\n        - name: elasticsearch-master\n          image: elasticsearch:7.2.0\n          command: [\"bash\", \"-c\", \"ulimit -l unlimited && sysctl -w vm.max_map_count=262144 && chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data && exec su elasticsearch docker-entrypoint.sh\"]\n          imagePullPolicy: IfNotPresent\n          volumeMounts:\n          - name: elasticsearch-data-nfs\n            mountPath: /usr/share/elasticsearch/data\n          securityContext:\n            privileged: true\n          ports:\n            - containerPort: 9200\n              protocol: TCP\n            - containerPort: 9300\n              protocol: TCP\n          env:\n            - name: cluster.name\n              value: \"es_cluster\"\n            - name: node.master\n              value: \"true\"\n            - name: node.data\n              value: \"true\"\n            - name: cluster.initial_master_nodes\n              value: \"elasticsearch-master-0,elasticsearch-master-1\" # 根据副本数和name配置\n            - name: discovery.zen.ping_timeout\n              value: \"5s\"\n            - name: node.ingest\n              value: \"false\"\n            - name: ES_JAVA_OPTS\n              value: \"-Xms1g -Xmx1g\"\n            - name: \"discovery.zen.ping.unicast.hosts\"\n              value: \"elasticsearch-discovery\" # Disvocery Service\n            - name: \"http.cors.enabled\"\n              value: \"true\"\n            - name: \"http.cors.allow-origin\"\n              value: \"*\"\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: elasticsearch\n  name: elasticsearch-discovery\n  namespace: ns-elastic\nspec:\n  publishNotReadyAddresses: true\n  ports:\n  - name: transport\n    port: 9300\n    targetPort: 9300\n  selector:\n    app: elasticsearch\n    role: master\n---\nkind: Service\napiVersion: v1\nmetadata:\n labels:\n   app: elasticsearch\n name: elasticsearch-service\n namespace: ns-elastic\nspec:\n type: NodePort\n ports:\n   - port: 9200\n     targetPort: 9200\n     nodePort: 19220\n     protocol: TCP\n selector:\n   app: elasticsearch\n```\n\n\n### 3. kibana配置k8s-kibana-7.2.0.yml\n```\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: kibana-config\n  namespace: ns-elastic7\n  labels:\n    elastic-app: kibana\ndata:\n  kibana.yml: |\n    server.name: kibana\n    server.host: \"0\"\n    elasticsearch.hosts: [ \"http://elasticsearch-service:9200\" ]\n    xpack.monitoring.ui.container.elasticsearch.enabled: true\n---\nkind: Deployment\napiVersion: apps/v1beta2\nmetadata:\n  labels:\n    elastic-app: kibana\n  name: kibana\n  namespace: ns-elastic7\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      elastic-app: kibana\n  template:\n    metadata:\n      labels:\n        elastic-app: kibana\n    spec:\n      containers:\n        - name: kibana\n          image: hub.boqii.com/bq/kibana:7.2.0\n          ports:\n            - containerPort: 5601\n              protocol: TCP\n          resources:\n            requests:\n              cpu: \"50m\"\n            limits:\n              cpu: \"800m\"\n          volumeMounts:\n            - name: kibana-config\n              mountPath: /usr/share/kibana/config\n      volumes:\n        - name: kibana-config\n          configMap:\n            name: kibana-config\n      tolerations:\n        - key: node-role.kubernetes.io/master\n          effect: NoSchedule\n\n---\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    elastic-app: kibana\n  name: kibana-service\n  namespace: ns-elastic7\nspec:\n  ports:\n    - port: 5601\n      targetPort: 5601\n  selector:\n    elastic-app: kibana\n  type: NodePort\n---\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n labels:\n   elastic-app: kibana\n name: kibana-ingress\n namespace: ns-elastic7\nspec:\n rules:\n   - host: elk-kibana-dev.boqii.com\n     http:\n       paths:\n         - backend:\n             serviceName: kibana-service\n             servicePort: 5601\n```\n\n### 4. logstash配置 本地挂载 k8s-logstash-7.2.0.yml\n- 4.1 config/pipelines.yml\n```\n- pipeline.id: main\n  path.config: \"/usr/share/logstash/config/pipeline/*.conf\"\n```\n\n- 4.2 首先配置grok规则 config/pipeline/logstash.conf\n```\ninput {\n    udp {\n        port => \"10000\"\n        }\n    }\n\n filter {\n      grok {\n          match => {\n            \"message\" => \"\\{\\\"id\\\":\\\"(?<id>(.)*)\\\",\\\"tag\\\":\\\"(?<tag>(.)*)\\\",\\\"title\\\":\\\"%{GREEDYDATA:title}(?<title>(.|\\r|\\n)*)\\\",\\\"value\\\":\\\"%{GREEDYDATA:value}(?<value>(.|\\r|\\n)*)\\\",\\\"createdAt\\\":\\\"(?<createdAt>\\S+ \\S+)\\\",\\\"Telephone\\\":\\\"(?<Telephone>(.)*)\\\",\\\"uid\\\":\\\"(?<uid>(.)*)\\\",\\\"updateTime\\\":\\\"(?<updateTime>(.)*)\\\",\\\"appVersion\\\":\\\"(?<appVersion>(.)*)\\\",\\\"mobileModel\\\":\\\"(?<mobileModel>(.)*)\\\",\\\"osVersion\\\":\\\"(?<osVersion>(.)*)\\\",\\\"channel\\\":\\\"(?<channel>(.)*)\\\",\\\"UDID\\\":\\\"(?<UDID>(.)*)\\\"\\}\"\n              }\n            }\n }\n\noutput {\n    elasticsearch {\n        hosts =>  [ \"http://elasticsearch-service:9200\" ]\n        index => \"k8s2-dev-%{+YYYY.MM.dd}\"\n\n        }\n\n    }\n```\n\n- 4.3 配置文件 k8s-logstash-7.2.0.yml\n```\n---\nkind: Deployment\napiVersion: apps/v1beta2\nmetadata:\n  labels:\n    elastic-app: logstash\n  name: logstash\n  namespace: ns-elastic\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      elastic-app: logstash\n  template:\n    metadata:\n      labels:\n        elastic-app: logstash\n    spec:\n      containers:\n        - name: logstash\n          image: hub.boqii.com/bq/logstash:7.2.0\n          ports:\n            - containerPort: 10000\n              protocol: UDP\n          volumeMounts:\n            - name: logstash-config\n              mountPath: /usr/share/logstash/config\n      volumes:\n        - name: logstash-config\n          hostPath:\n            path: /data/k8s-pod/elk-7.2.0/logstash-7.2.0/config\n      tolerations:\n        - key: node-role.kubernetes.io/master\n          effect: NoSchedule\n\n---\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    elastic-app: logstash\n  name: logstash-service\n  namespace: ns-elastic\nspec:\n  type: NodePort\n  ports:\n    - port: 10000\n      targetPort: 10000\n      nodePort: 10000\n      protocol: UDP\n  selector:\n    elastic-app: logstash\n  type: NodePort\n---\n```\n","slug":"2-部署elk7-2-0","published":1,"updated":"2019-09-24T02:38:35.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck0x8fst000097g9k74o6emtx","content":"<blockquote>\n<p>说明:</p>\n</blockquote>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">1 </span>单台k8s,本机目录挂载(未配置cephfs)</span><br><span class=\"line\"><span class=\"symbol\">2 </span>如果replicas大于<span class=\"number\">1</span>, 就会出现多个es挂载同一个目录,会出现报错(uuid block)</span><br></pre></td></tr></table></figure>\n\n <a id=\"more\"></a>\n\n<h3 id=\"1-es配置本地挂载-k8s-es-7-2-0-yml\"><a href=\"#1-es配置本地挂载-k8s-es-7-2-0-yml\" class=\"headerlink\" title=\"1. es配置本地挂载 k8s-es-7.2.0.yml\"></a>1. es配置本地挂载 k8s-es-7.2.0.yml</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.authorization.k8s.io/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">roleRef:</span></span><br><span class=\"line\"><span class=\"attr\"> apiGroup:</span> <span class=\"string\">rbac.authorization.k8s.io</span></span><br><span class=\"line\"><span class=\"attr\"> kind:</span> <span class=\"string\">ClusterRole</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">cluster-admin</span></span><br><span class=\"line\"><span class=\"attr\">subjects:</span></span><br><span class=\"line\"><span class=\"attr\"> - kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">   name:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\">   namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">StatefulSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  serviceName:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">      role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">        role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      serviceAccountName:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\">      restartPolicy:</span> <span class=\"string\">Always</span></span><br><span class=\"line\"><span class=\"attr\">      securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">        fsGroup:</span> <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">hub.boqii.com/bq/elasticsearch:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          command:</span> <span class=\"string\">[\"bash\",</span> <span class=\"string\">\"-c\"</span><span class=\"string\">,</span> <span class=\"string\">\"ulimit -l unlimited &amp;&amp; sysctl -w vm.max_map_count=262144 &amp;&amp; chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data &amp;&amp; exec su elasticsearch docker-entrypoint.sh\"</span><span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">          imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\"><span class=\"attr\">          securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">            privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          resources:</span></span><br><span class=\"line\"><span class=\"attr\">            requests:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"50m\"</span></span><br><span class=\"line\"><span class=\"attr\">            limits:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"800m\"</span></span><br><span class=\"line\"><span class=\"attr\">          env:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.name</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"es_cluster\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.master</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.data</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.initial_master_nodes</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-master-0\"</span> <span class=\"comment\"># 根据副本数和name配置</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">discovery.zen.ping_timeout</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"5s\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.ingest</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"false\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">ES_JAVA_OPTS</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"-Xms1g -Xmx1g\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"discovery.zen.ping.unicast.hosts\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-discovery\"</span> <span class=\"comment\"># Disvocery Service</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.enabled\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.allow-origin\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"*\"</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">elasticsearch-data-volume</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/usr/share/elasticsearch/data</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">elasticsearch-data-volume</span></span><br><span class=\"line\"><span class=\"attr\">          hostPath:</span></span><br><span class=\"line\"><span class=\"attr\">            path:</span> <span class=\"string\">/data/k8s-container/elk-7.2.0/es-7.2.0/data</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-discovery</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  publishNotReadyAddresses:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">transport</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-service</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\"> type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\"> ports:</span></span><br><span class=\"line\"><span class=\"attr\">   - port:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     targetPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     nodePort:</span> <span class=\"number\">19230</span></span><br><span class=\"line\"><span class=\"attr\">     protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\"> selector:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-es配置nfs动态挂载-k8s-es-7-2-0-nfs-yml\"><a href=\"#2-es配置nfs动态挂载-k8s-es-7-2-0-nfs-yml\" class=\"headerlink\" title=\"2. es配置nfs动态挂载 k8s-es-7.2.0-nfs.yml\"></a>2. es配置nfs动态挂载 k8s-es-7.2.0-nfs.yml</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.authorization.k8s.io/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">roleRef:</span></span><br><span class=\"line\"><span class=\"attr\"> apiGroup:</span> <span class=\"string\">rbac.authorization.k8s.io</span></span><br><span class=\"line\"><span class=\"attr\"> kind:</span> <span class=\"string\">ClusterRole</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">cluster-admin</span></span><br><span class=\"line\"><span class=\"attr\">subjects:</span></span><br><span class=\"line\"><span class=\"attr\"> - kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">   name:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\">   namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">StatefulSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"attr\">  volumeClaimTemplates:</span></span><br><span class=\"line\"><span class=\"attr\">  - metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      name:</span> <span class=\"string\">elasticsearch-data-nfs</span></span><br><span class=\"line\"><span class=\"attr\">      annotations:</span></span><br><span class=\"line\">        <span class=\"string\">volume.beta.kubernetes.io/storage-class:</span> <span class=\"string\">\"nfs\"</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      accessModes:</span> <span class=\"string\">[</span> <span class=\"string\">\"ReadWriteOnce\"</span> <span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">      resources:</span></span><br><span class=\"line\"><span class=\"attr\">        requests:</span></span><br><span class=\"line\"><span class=\"attr\">          storage:</span> <span class=\"number\">2</span><span class=\"string\">Gi</span></span><br><span class=\"line\"><span class=\"attr\">  serviceName:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">      role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">        role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      serviceAccountName:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\">      restartPolicy:</span> <span class=\"string\">Always</span></span><br><span class=\"line\"><span class=\"attr\">      securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">        fsGroup:</span> <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"attr\">elasticsearch:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          command:</span> <span class=\"string\">[\"bash\",</span> <span class=\"string\">\"-c\"</span><span class=\"string\">,</span> <span class=\"string\">\"ulimit -l unlimited &amp;&amp; sysctl -w vm.max_map_count=262144 &amp;&amp; chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data &amp;&amp; exec su elasticsearch docker-entrypoint.sh\"</span><span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">          imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">          - name:</span> <span class=\"string\">elasticsearch-data-nfs</span></span><br><span class=\"line\"><span class=\"attr\">            mountPath:</span> <span class=\"string\">/usr/share/elasticsearch/data</span></span><br><span class=\"line\"><span class=\"attr\">          securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">            privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          env:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.name</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"es_cluster\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.master</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.data</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.initial_master_nodes</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-master-0,elasticsearch-master-1\"</span> <span class=\"comment\"># 根据副本数和name配置</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">discovery.zen.ping_timeout</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"5s\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.ingest</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"false\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">ES_JAVA_OPTS</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"-Xms1g -Xmx1g\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"discovery.zen.ping.unicast.hosts\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-discovery\"</span> <span class=\"comment\"># Disvocery Service</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.enabled\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.allow-origin\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"*\"</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-discovery</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  publishNotReadyAddresses:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">transport</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-service</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\"> type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\"> ports:</span></span><br><span class=\"line\"><span class=\"attr\">   - port:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     targetPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     nodePort:</span> <span class=\"number\">19220</span></span><br><span class=\"line\"><span class=\"attr\">     protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\"> selector:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-kibana配置k8s-kibana-7-2-0-yml\"><a href=\"#3-kibana配置k8s-kibana-7-2-0-yml\" class=\"headerlink\" title=\"3. kibana配置k8s-kibana-7.2.0.yml\"></a>3. kibana配置k8s-kibana-7.2.0.yml</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ConfigMap</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">data:</span></span><br><span class=\"line\">  <span class=\"string\">kibana.yml:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">    server.name: kibana</span></span><br><span class=\"line\"><span class=\"string\">    server.host: \"0\"</span></span><br><span class=\"line\"><span class=\"string\">    elasticsearch.hosts: [ \"http://elasticsearch-service:9200\" ]</span></span><br><span class=\"line\"><span class=\"string\">    xpack.monitoring.ui.container.elasticsearch.enabled: true</span></span><br><span class=\"line\"><span class=\"string\">---</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1beta2</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  revisionHistoryLimit:</span> <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">hub.boqii.com/bq/kibana:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          resources:</span></span><br><span class=\"line\"><span class=\"attr\">            requests:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"50m\"</span></span><br><span class=\"line\"><span class=\"attr\">            limits:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"800m\"</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/usr/share/kibana/config</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">          configMap:</span></span><br><span class=\"line\"><span class=\"attr\">            name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">      tolerations:</span></span><br><span class=\"line\"><span class=\"attr\">        - key:</span> <span class=\"string\">node-role.kubernetes.io/master</span></span><br><span class=\"line\"><span class=\"attr\">          effect:</span> <span class=\"string\">NoSchedule</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kibana-service</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">    - port:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">      targetPort:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">extensions/v1beta1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Ingress</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">kibana-ingress</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\"> rules:</span></span><br><span class=\"line\"><span class=\"attr\">   - host:</span> <span class=\"string\">elk-kibana-dev.boqii.com</span></span><br><span class=\"line\"><span class=\"attr\">     http:</span></span><br><span class=\"line\"><span class=\"attr\">       paths:</span></span><br><span class=\"line\"><span class=\"attr\">         - backend:</span></span><br><span class=\"line\"><span class=\"attr\">             serviceName:</span> <span class=\"string\">kibana-service</span></span><br><span class=\"line\"><span class=\"attr\">             servicePort:</span> <span class=\"number\">5601</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-logstash配置-本地挂载-k8s-logstash-7-2-0-yml\"><a href=\"#4-logstash配置-本地挂载-k8s-logstash-7-2-0-yml\" class=\"headerlink\" title=\"4. logstash配置 本地挂载 k8s-logstash-7.2.0.yml\"></a>4. logstash配置 本地挂载 k8s-logstash-7.2.0.yml</h3><ul>\n<li><p>4.1 config/pipelines.yml</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- pipeline<span class=\"selector-class\">.id</span>: main</span><br><span class=\"line\">  path<span class=\"selector-class\">.config</span>: <span class=\"string\">\"/usr/share/logstash/config/pipeline/*.conf\"</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>4.2 首先配置grok规则 config/pipeline/logstash.conf</p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">    udp &#123;</span><br><span class=\"line\">        port =&gt; <span class=\"string\">\"10000\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> filter &#123;</span><br><span class=\"line\">      grok &#123;</span><br><span class=\"line\">          match =&gt; &#123;</span><br><span class=\"line\">            <span class=\"string\">\"message\"</span> =&gt; <span class=\"string\">\"\\&#123;<span class=\"subst\">\\\"</span>id<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;id&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>tag<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;tag&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>title<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>%&#123;GREEDYDATA:title&#125;(?&lt;title&gt;(.|\\r|<span class=\"subst\">\\n</span>)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>value<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>%&#123;GREEDYDATA:value&#125;(?&lt;value&gt;(.|\\r|<span class=\"subst\">\\n</span>)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>createdAt<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;createdAt&gt;\\S+ \\S+)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>Telephone<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;Telephone&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>uid<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;uid&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>updateTime<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;updateTime&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>appVersion<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;appVersion&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>mobileModel<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;mobileModel&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>osVersion<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;osVersion&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>channel<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;channel&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>UDID<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;UDID&gt;(.)*)<span class=\"subst\">\\\"</span>\\&#125;\"</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">output &#123;</span><br><span class=\"line\">    elasticsearch &#123;</span><br><span class=\"line\">        hosts =&gt;  [ <span class=\"string\">\"http://elasticsearch-service:9200\"</span> ]</span><br><span class=\"line\">        index =&gt; <span class=\"string\">\"k8s2-dev-%&#123;+YYYY.MM.dd&#125;\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>4.3 配置文件 k8s-logstash-7.2.0.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1beta2</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  revisionHistoryLimit:</span> <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">hub.boqii.com/bq/logstash:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">UDP</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">logstash-config</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/usr/share/logstash/config</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">logstash-config</span></span><br><span class=\"line\"><span class=\"attr\">          hostPath:</span></span><br><span class=\"line\"><span class=\"attr\">            path:</span> <span class=\"string\">/data/k8s-pod/elk-7.2.0/logstash-7.2.0/config</span></span><br><span class=\"line\"><span class=\"attr\">      tolerations:</span></span><br><span class=\"line\"><span class=\"attr\">        - key:</span> <span class=\"string\">node-role.kubernetes.io/master</span></span><br><span class=\"line\"><span class=\"attr\">          effect:</span> <span class=\"string\">NoSchedule</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">logstash-service</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">    - port:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">      targetPort:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">      nodePort:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">      protocol:</span> <span class=\"string\">UDP</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n","site":{"data":{}},"length":11167,"excerpt":"<blockquote>\n<p>说明:</p>\n</blockquote>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">1 </span>单台k8s,本机目录挂载(未配置cephfs)</span><br><span class=\"line\"><span class=\"symbol\">2 </span>如果replicas大于<span class=\"number\">1</span>, 就会出现多个es挂载同一个目录,会出现报错(uuid block)</span><br></pre></td></tr></table></figure>","more":"<h3 id=\"1-es配置本地挂载-k8s-es-7-2-0-yml\"><a href=\"#1-es配置本地挂载-k8s-es-7-2-0-yml\" class=\"headerlink\" title=\"1. es配置本地挂载 k8s-es-7.2.0.yml\"></a>1. es配置本地挂载 k8s-es-7.2.0.yml</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.authorization.k8s.io/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">roleRef:</span></span><br><span class=\"line\"><span class=\"attr\"> apiGroup:</span> <span class=\"string\">rbac.authorization.k8s.io</span></span><br><span class=\"line\"><span class=\"attr\"> kind:</span> <span class=\"string\">ClusterRole</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">cluster-admin</span></span><br><span class=\"line\"><span class=\"attr\">subjects:</span></span><br><span class=\"line\"><span class=\"attr\"> - kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">   name:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\">   namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">StatefulSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  serviceName:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">      role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">        role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      serviceAccountName:</span> <span class=\"string\">elasticsearch7-admin</span></span><br><span class=\"line\"><span class=\"attr\">      restartPolicy:</span> <span class=\"string\">Always</span></span><br><span class=\"line\"><span class=\"attr\">      securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">        fsGroup:</span> <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">hub.boqii.com/bq/elasticsearch:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          command:</span> <span class=\"string\">[\"bash\",</span> <span class=\"string\">\"-c\"</span><span class=\"string\">,</span> <span class=\"string\">\"ulimit -l unlimited &amp;&amp; sysctl -w vm.max_map_count=262144 &amp;&amp; chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data &amp;&amp; exec su elasticsearch docker-entrypoint.sh\"</span><span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">          imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\"><span class=\"attr\">          securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">            privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          resources:</span></span><br><span class=\"line\"><span class=\"attr\">            requests:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"50m\"</span></span><br><span class=\"line\"><span class=\"attr\">            limits:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"800m\"</span></span><br><span class=\"line\"><span class=\"attr\">          env:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.name</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"es_cluster\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.master</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.data</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.initial_master_nodes</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-master-0\"</span> <span class=\"comment\"># 根据副本数和name配置</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">discovery.zen.ping_timeout</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"5s\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.ingest</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"false\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">ES_JAVA_OPTS</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"-Xms1g -Xmx1g\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"discovery.zen.ping.unicast.hosts\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-discovery\"</span> <span class=\"comment\"># Disvocery Service</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.enabled\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.allow-origin\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"*\"</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">elasticsearch-data-volume</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/usr/share/elasticsearch/data</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">elasticsearch-data-volume</span></span><br><span class=\"line\"><span class=\"attr\">          hostPath:</span></span><br><span class=\"line\"><span class=\"attr\">            path:</span> <span class=\"string\">/data/k8s-container/elk-7.2.0/es-7.2.0/data</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-discovery</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  publishNotReadyAddresses:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">transport</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-service</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\"> type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\"> ports:</span></span><br><span class=\"line\"><span class=\"attr\">   - port:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     targetPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     nodePort:</span> <span class=\"number\">19230</span></span><br><span class=\"line\"><span class=\"attr\">     protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\"> selector:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-es配置nfs动态挂载-k8s-es-7-2-0-nfs-yml\"><a href=\"#2-es配置nfs动态挂载-k8s-es-7-2-0-nfs-yml\" class=\"headerlink\" title=\"2. es配置nfs动态挂载 k8s-es-7.2.0-nfs.yml\"></a>2. es配置nfs动态挂载 k8s-es-7.2.0-nfs.yml</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">rbac.authorization.k8s.io/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ClusterRoleBinding</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">roleRef:</span></span><br><span class=\"line\"><span class=\"attr\"> apiGroup:</span> <span class=\"string\">rbac.authorization.k8s.io</span></span><br><span class=\"line\"><span class=\"attr\"> kind:</span> <span class=\"string\">ClusterRole</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">cluster-admin</span></span><br><span class=\"line\"><span class=\"attr\">subjects:</span></span><br><span class=\"line\"><span class=\"attr\"> - kind:</span> <span class=\"string\">ServiceAccount</span></span><br><span class=\"line\"><span class=\"attr\">   name:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\">   namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">StatefulSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"attr\">  volumeClaimTemplates:</span></span><br><span class=\"line\"><span class=\"attr\">  - metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      name:</span> <span class=\"string\">elasticsearch-data-nfs</span></span><br><span class=\"line\"><span class=\"attr\">      annotations:</span></span><br><span class=\"line\">        <span class=\"string\">volume.beta.kubernetes.io/storage-class:</span> <span class=\"string\">\"nfs\"</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      accessModes:</span> <span class=\"string\">[</span> <span class=\"string\">\"ReadWriteOnce\"</span> <span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">      resources:</span></span><br><span class=\"line\"><span class=\"attr\">        requests:</span></span><br><span class=\"line\"><span class=\"attr\">          storage:</span> <span class=\"number\">2</span><span class=\"string\">Gi</span></span><br><span class=\"line\"><span class=\"attr\">  serviceName:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">      role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">        role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      serviceAccountName:</span> <span class=\"string\">elasticsearch-admin</span></span><br><span class=\"line\"><span class=\"attr\">      restartPolicy:</span> <span class=\"string\">Always</span></span><br><span class=\"line\"><span class=\"attr\">      securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">        fsGroup:</span> <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">elasticsearch-master</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"attr\">elasticsearch:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          command:</span> <span class=\"string\">[\"bash\",</span> <span class=\"string\">\"-c\"</span><span class=\"string\">,</span> <span class=\"string\">\"ulimit -l unlimited &amp;&amp; sysctl -w vm.max_map_count=262144 &amp;&amp; chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data &amp;&amp; exec su elasticsearch docker-entrypoint.sh\"</span><span class=\"string\">]</span></span><br><span class=\"line\"><span class=\"attr\">          imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">          - name:</span> <span class=\"string\">elasticsearch-data-nfs</span></span><br><span class=\"line\"><span class=\"attr\">            mountPath:</span> <span class=\"string\">/usr/share/elasticsearch/data</span></span><br><span class=\"line\"><span class=\"attr\">          securityContext:</span></span><br><span class=\"line\"><span class=\"attr\">            privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          env:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.name</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"es_cluster\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.master</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.data</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">cluster.initial_master_nodes</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-master-0,elasticsearch-master-1\"</span> <span class=\"comment\"># 根据副本数和name配置</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">discovery.zen.ping_timeout</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"5s\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">node.ingest</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"false\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">ES_JAVA_OPTS</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"-Xms1g -Xmx1g\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"discovery.zen.ping.unicast.hosts\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"elasticsearch-discovery\"</span> <span class=\"comment\"># Disvocery Service</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.enabled\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"true\"</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">\"http.cors.allow-origin\"</span></span><br><span class=\"line\"><span class=\"attr\">              value:</span> <span class=\"string\">\"*\"</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">elasticsearch-discovery</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  publishNotReadyAddresses:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">  - name:</span> <span class=\"string\">transport</span></span><br><span class=\"line\"><span class=\"attr\">    port:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">    targetPort:</span> <span class=\"number\">9300</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\">    role:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">elasticsearch-service</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\"> type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\"> ports:</span></span><br><span class=\"line\"><span class=\"attr\">   - port:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     targetPort:</span> <span class=\"number\">9200</span></span><br><span class=\"line\"><span class=\"attr\">     nodePort:</span> <span class=\"number\">19220</span></span><br><span class=\"line\"><span class=\"attr\">     protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\"> selector:</span></span><br><span class=\"line\"><span class=\"attr\">   app:</span> <span class=\"string\">elasticsearch</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-kibana配置k8s-kibana-7-2-0-yml\"><a href=\"#3-kibana配置k8s-kibana-7-2-0-yml\" class=\"headerlink\" title=\"3. kibana配置k8s-kibana-7.2.0.yml\"></a>3. kibana配置k8s-kibana-7.2.0.yml</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">ConfigMap</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">data:</span></span><br><span class=\"line\">  <span class=\"string\">kibana.yml:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">    server.name: kibana</span></span><br><span class=\"line\"><span class=\"string\">    server.host: \"0\"</span></span><br><span class=\"line\"><span class=\"string\">    elasticsearch.hosts: [ \"http://elasticsearch-service:9200\" ]</span></span><br><span class=\"line\"><span class=\"string\">    xpack.monitoring.ui.container.elasticsearch.enabled: true</span></span><br><span class=\"line\"><span class=\"string\">---</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1beta2</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  revisionHistoryLimit:</span> <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">hub.boqii.com/bq/kibana:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">TCP</span></span><br><span class=\"line\"><span class=\"attr\">          resources:</span></span><br><span class=\"line\"><span class=\"attr\">            requests:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"50m\"</span></span><br><span class=\"line\"><span class=\"attr\">            limits:</span></span><br><span class=\"line\"><span class=\"attr\">              cpu:</span> <span class=\"string\">\"800m\"</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/usr/share/kibana/config</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">          configMap:</span></span><br><span class=\"line\"><span class=\"attr\">            name:</span> <span class=\"string\">kibana-config</span></span><br><span class=\"line\"><span class=\"attr\">      tolerations:</span></span><br><span class=\"line\"><span class=\"attr\">        - key:</span> <span class=\"string\">node-role.kubernetes.io/master</span></span><br><span class=\"line\"><span class=\"attr\">          effect:</span> <span class=\"string\">NoSchedule</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">kibana-service</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">    - port:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">      targetPort:</span> <span class=\"number\">5601</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">extensions/v1beta1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Ingress</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\"> labels:</span></span><br><span class=\"line\"><span class=\"attr\">   elastic-app:</span> <span class=\"string\">kibana</span></span><br><span class=\"line\"><span class=\"attr\"> name:</span> <span class=\"string\">kibana-ingress</span></span><br><span class=\"line\"><span class=\"attr\"> namespace:</span> <span class=\"string\">ns-elastic7</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\"> rules:</span></span><br><span class=\"line\"><span class=\"attr\">   - host:</span> <span class=\"string\">elk-kibana-dev.boqii.com</span></span><br><span class=\"line\"><span class=\"attr\">     http:</span></span><br><span class=\"line\"><span class=\"attr\">       paths:</span></span><br><span class=\"line\"><span class=\"attr\">         - backend:</span></span><br><span class=\"line\"><span class=\"attr\">             serviceName:</span> <span class=\"string\">kibana-service</span></span><br><span class=\"line\"><span class=\"attr\">             servicePort:</span> <span class=\"number\">5601</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-logstash配置-本地挂载-k8s-logstash-7-2-0-yml\"><a href=\"#4-logstash配置-本地挂载-k8s-logstash-7-2-0-yml\" class=\"headerlink\" title=\"4. logstash配置 本地挂载 k8s-logstash-7.2.0.yml\"></a>4. logstash配置 本地挂载 k8s-logstash-7.2.0.yml</h3><ul>\n<li><p>4.1 config/pipelines.yml</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- pipeline<span class=\"selector-class\">.id</span>: main</span><br><span class=\"line\">  path<span class=\"selector-class\">.config</span>: <span class=\"string\">\"/usr/share/logstash/config/pipeline/*.conf\"</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>4.2 首先配置grok规则 config/pipeline/logstash.conf</p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">input &#123;</span><br><span class=\"line\">    udp &#123;</span><br><span class=\"line\">        port =&gt; <span class=\"string\">\"10000\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> filter &#123;</span><br><span class=\"line\">      grok &#123;</span><br><span class=\"line\">          match =&gt; &#123;</span><br><span class=\"line\">            <span class=\"string\">\"message\"</span> =&gt; <span class=\"string\">\"\\&#123;<span class=\"subst\">\\\"</span>id<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;id&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>tag<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;tag&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>title<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>%&#123;GREEDYDATA:title&#125;(?&lt;title&gt;(.|\\r|<span class=\"subst\">\\n</span>)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>value<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>%&#123;GREEDYDATA:value&#125;(?&lt;value&gt;(.|\\r|<span class=\"subst\">\\n</span>)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>createdAt<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;createdAt&gt;\\S+ \\S+)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>Telephone<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;Telephone&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>uid<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;uid&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>updateTime<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;updateTime&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>appVersion<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;appVersion&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>mobileModel<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;mobileModel&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>osVersion<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;osVersion&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>channel<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;channel&gt;(.)*)<span class=\"subst\">\\\"</span>,<span class=\"subst\">\\\"</span>UDID<span class=\"subst\">\\\"</span>:<span class=\"subst\">\\\"</span>(?&lt;UDID&gt;(.)*)<span class=\"subst\">\\\"</span>\\&#125;\"</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">output &#123;</span><br><span class=\"line\">    elasticsearch &#123;</span><br><span class=\"line\">        hosts =&gt;  [ <span class=\"string\">\"http://elasticsearch-service:9200\"</span> ]</span><br><span class=\"line\">        index =&gt; <span class=\"string\">\"k8s2-dev-%&#123;+YYYY.MM.dd&#125;\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>4.3 配置文件 k8s-logstash-7.2.0.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1beta2</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attr\">  revisionHistoryLimit:</span> <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    matchLabels:</span></span><br><span class=\"line\"><span class=\"attr\">      elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  template:</span></span><br><span class=\"line\"><span class=\"attr\">    metadata:</span></span><br><span class=\"line\"><span class=\"attr\">      labels:</span></span><br><span class=\"line\"><span class=\"attr\">        elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">    spec:</span></span><br><span class=\"line\"><span class=\"attr\">      containers:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">          image:</span> <span class=\"string\">hub.boqii.com/bq/logstash:7.2.0</span></span><br><span class=\"line\"><span class=\"attr\">          ports:</span></span><br><span class=\"line\"><span class=\"attr\">            - containerPort:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">              protocol:</span> <span class=\"string\">UDP</span></span><br><span class=\"line\"><span class=\"attr\">          volumeMounts:</span></span><br><span class=\"line\"><span class=\"attr\">            - name:</span> <span class=\"string\">logstash-config</span></span><br><span class=\"line\"><span class=\"attr\">              mountPath:</span> <span class=\"string\">/usr/share/logstash/config</span></span><br><span class=\"line\"><span class=\"attr\">      volumes:</span></span><br><span class=\"line\"><span class=\"attr\">        - name:</span> <span class=\"string\">logstash-config</span></span><br><span class=\"line\"><span class=\"attr\">          hostPath:</span></span><br><span class=\"line\"><span class=\"attr\">            path:</span> <span class=\"string\">/data/k8s-pod/elk-7.2.0/logstash-7.2.0/config</span></span><br><span class=\"line\"><span class=\"attr\">      tolerations:</span></span><br><span class=\"line\"><span class=\"attr\">        - key:</span> <span class=\"string\">node-role.kubernetes.io/master</span></span><br><span class=\"line\"><span class=\"attr\">          effect:</span> <span class=\"string\">NoSchedule</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\"><span class=\"attr\">  labels:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  name:</span> <span class=\"string\">logstash-service</span></span><br><span class=\"line\"><span class=\"attr\">  namespace:</span> <span class=\"string\">ns-elastic</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"attr\">  ports:</span></span><br><span class=\"line\"><span class=\"attr\">    - port:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">      targetPort:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">      nodePort:</span> <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"attr\">      protocol:</span> <span class=\"string\">UDP</span></span><br><span class=\"line\"><span class=\"attr\">  selector:</span></span><br><span class=\"line\"><span class=\"attr\">    elastic-app:</span> <span class=\"string\">logstash</span></span><br><span class=\"line\"><span class=\"attr\">  type:</span> <span class=\"string\">NodePort</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>"},{"title":"首次搭建hexo博客系统","date":"2019-09-19T09:24:53.000Z","copyright":true,"top":10,"_content":"### 1 安装hexo\n- 1.1 在mac上安装\n```\n# 安装node\nbrew install node npm\n```\n <!-- more -->\n\n- 1.2 在linux安装\n```\n# 安装node10\ncurl -sL https://rpm.nodesource.com/setup_10.x | bash -\nyum install -y nodejs\n```\n\n- 1.3 安装hexo\n```\n# 安装hexo\nnpm install -g hexo\n```\n\n\n### 2 初始化\n```\ncd /data/github/\n# 初始化\n\nhexo init blog\n# 框架安装\nnpm install\n\n#安装 Hexo 关于启动服务器的插件\nnpm install hexo-server --save\n\n# 启动服务器, 本地查看效果, 如果不指定端口，默认为4000\nhexo server\n\n```\n\n### 3 主题和配置\n- 下载主题：[https://github.com/theme-next/hexo-theme-next](https://github.com/theme-next/hexo-theme-next)\n```\nunzip hexo-theme-next-master.zip\nmv hexo-theme-next-master $blog/themes/\n```\n\n- 修改主题配置 _config.yml 中的其他属性\n```\ntitle: Zhangzhiwei's Blog\n...\ntheme: hexo-theme-next\n...\nscheme: Mist\n```\n\n### 4. 编写更新博客\n\n- 创建博客\n```\nhexo new '第一个博客'\n```\n\n- cat source/_posts/第一个博客.md\n```\ntitle: 第一个博客\ndate: 2019-09-19 16:58:01\ntags:\n  - hexo\ncategories:\n  - hexo学习\n```\n\n- github 创建一个Repository仓库\n```\n1. 仓库名字必须是 xxx.github.io\n2. 在settings中 勾选Template repository\n3. 记得添加自己的ssh\n```\n\n\n\n- github配置\n```\n # 安装 hexo 关于 git 的组件\nnpm install hexo-deployer-git --save\n```\n\n- 在_config.yml 中为 git 添加配置\n```\ndeploy:\n  type: git\n  repository: git@github.com:*/*.github.io.git\n  branch: master\n```\n\n- 查看是否能提交代码github\n```\nssh -T -ai ~/.ssh/id_rsa git@github.com\n```\n\n- 部署\n```\nhexo g\nhexo d\n或者\nhexo d -g\n```\n\n### 5. next6让首页文字预览显示\n```\n1. 找到主题的配置文件(themes/hexo-theme-next/_config.yml)\n2. 修改auto_excerpt,把enable改为对应的false改为true\n3. hexo d -g\n```\n\n### 6. next6添加搜索功能\n```\n1. npm install hexo-generator-searchdb --save\n2. 全局配置文件_config.yml\nsearch:\n  path: search.xml\n  field: post\n  format: html\n  limit: 10000\n3. 修改主题的_config.yml\nlocal_search:\n  enable: true\n```\n\n### 7. next6 Mist字体的 首页文章间距和首页页宽,字体\n- 7.1 首页文章间距\n\n\t```\n\t增加一些内容: source/css/_schemes/Mist/_posts-expanded.styl\n\t.posts-expand .post {\n\t  margin-top: 30px;\n\t  margin-bottom: 30px;\n\t}\n\t\n\t```\n\n- 7.2 页宽\n\n\t```\n\tsource/css/_variables/base.styl\n\t$content-desktop                = 900px\n\t$content-desktop-large          = 1000px\n\t$content-desktop-largest        = 1100px\n\t```\n\n- 7.3 字体大小\n\n```\nthemes/next/source/css/_variables/base.styl\n\n$font-size-base           = 0.95em;\n$font-size-base           = unit(hexo-config('font.global.size'), em) if hexo-config('font.global.size') is a 'unit';\n$font-size-smallest       = .75em;\n$font-size-smaller        = .8125em;\n$font-size-small          = .855em;\n$font-size-medium         = 0.95em;\n$font-size-large          = 0.975em;\n$font-size-larger         = 1.em;\n$font-size-largest        = 1.125em;\n```\n\n### 8. 添加网格\n-  8.1 自定义方式修改\n\n\t```\n\t# 新创建自定义文件\n\tcat themes/next/source/css/_custom/custom.styl\n\t// 主页文章添加阴影效果\n\t.post {\n\tmargin-top: 60px;\n\tmargin-bottom: 60px;\n\tpadding: 25px;\n\t-webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);\n\t-moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);\n\t}\n\n\t# 修改config文件\n\tvim ./themes/next/_config.yml\n\tcustom: custom\n\t```\n\n- 8.2 next6版本修改方式\n\t> 参考: [hexo6--next美化整理](https://www.jianshu.com/p/ec2e6c8a1d89)\n\n\t1. 修改 themes/next/layout/_layout.swig\n\t```\n\t{% if theme.canvas_nest %}\n\t<script type=\"text/javascript\" src=\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\">\n\t</script>\n\t{% endif %}\n\t```\n\n\t> 将上述代码防止在< /body> 前就可以了(注意不要放在< /head>的后面)。\n\n\t2. 修改主题的_config.yml\n\n\t```\n\tcanvas_nest: true\n\n\t//color: 线条颜色, 默认: '0,0,0'；三个数字分别为(R,G,B)\n\t//opacity: 线条透明度（0~1）, 默认: 0.5\n\t//count: 线条的总数量, 默认: 150\n\t//zIndex: 背景的z-index属性，css属性用于控制所在层的位置, 默认: -1\n\t```\n> 注意:\n我这里打开提示缺少 canvas-nest.min.js文件,这里是手动copy的一份写到 source/lib/canvas-nest/canvas-nest.min.js\n\n```\n!function(){function o(w,v,i){return w.getAttribute(v)||i}function j(i){return document.getElementsByTagName(i)}function l(){var i=j(\"script\"),w=i.length,v=i[w-1];return{l:w,z:o(v,\"zIndex\",-1),o:o(v,\"opacity\",0.5),c:o(v,\"color\",\"0,0,0\"),n:o(v,\"count\",99)}}function k(){r=u.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=u.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function b(){e.clearRect(0,0,r,n);var w=[f].concat(t);var x,v,A,B,z,y;t.forEach(function(i){i.x+=i.xa,i.y+=i.ya,i.xa*=i.x>r||i.x<0?-1:1,i.ya*=i.y>n||i.y<0?-1:1,e.fillRect(i.x-0.5,i.y-0.5,1,1);for(v=0;v<w.length;v++){x=w[v];if(i!==x&&null!==x.x&&null!==x.y){B=i.x-x.x,z=i.y-x.y,y=B*B+z*z;y<x.max&&(x===f&&y>=x.max/2&&(i.x-=0.03*B,i.y-=0.03*z),A=(x.max-y)/x.max,e.beginPath(),e.lineWidth=A/2,e.strokeStyle=\"rgba(\"+s.c+\",\"+(A+0.2)+\")\",e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.stroke())}}w.splice(w.indexOf(i),1)}),m(b)}var u=document.createElement(\"canvas\"),s=l(),c=\"c_n\"+s.l,e=u.getContext(\"2d\"),r,n,m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){window.setTimeout(i,1000/45)},a=Math.random,f={x:null,y:null,max:20000};u.id=c;u.style.cssText=\"position:fixed;top:0;left:0;z-index:\"+s.z+\";opacity:\"+s.o;j(\"body\")[0].appendChild(u);k(),window.onresize=k;window.onmousemove=function(i){i=i||window.event,f.x=i.clientX,f.y=i.clientY},window.onmouseout=function(){f.x=null,f.y=null};for(var t=[],p=0;s.n>p;p++){var h=a()*r,g=a()*n,q=2*a()-1,d=2*a()-1;t.push({x:h,y:g,xa:q,ya:d,max:6000})}setTimeout(function(){b()},100)}();%                                                                                                    zhangzw@MacBook-Pro  /data/github/blog   master ● \n```\n\n### 9. 添加评论功能\n\n- 9.1 注册leancloud\n ```\n 注册-> 验证邮箱-> 实名认证 -> 设置获取appid和appkey\n ```\n\n- 9.2 修改配置文件\n ```\n valine:\n   enable: true \n   appid: 'appid' \n   appkey: 'appkey' \n   placeholder: \"ヾﾉ≧∀≦)o 来呀！快活呀！~啦啦啦~ 啦啦啦啦~\" \n   visitor: true //这个打开页会统计文章阅读数\n ```\n\n\n\n\n### 10. next6添加字数统计 和阅读时长\n\n> [hexo-symbols-count-time](https://github.com/theme-next/hexo-symbols-count-time)\n\n- 10.1 安装node扩展\n ```\n npm install hexo-symbols-count-time --save\n ```\n\n- 10.2 修改全局配置 _config.yml\n ```\n symbols_count_time:\n   symbols: true\n   time: true\n   total_symbols: true\n   total_time: true\n   exclude_codeblock: false\n ```\n\n- 10.3 修改主题配置 _config.yml\n ```\n symbols_count_time:\n   separated_meta: true\n   item_text_post: true\n   item_text_total: false\n   awl: 4\n   wpm: 275\n   suffix: mins.\n ```\n\n\n\n### 11. next6 文章置顶功能\n\n- 11.1 安装node扩展 \n ```\n npm uninstall hexo-generator-index --save\n npm install hexo-generator-index-pin-top --save\n ```\n\n- 11.2 在文章开头添加置顶标识\n ```\n top: 10\n ```\n\n- 11.3 首页添加明显置顶标识\n ```\n themes/next/layout/_macro/post.swig 在<div class=\"post-meta\"> 下添加如下代码\n {% if post.top %}\n     <i class=\"fa fa-thumb-tack\"></i>\n     <font color=green>置顶</font>\n     <span class=\"post-meta-divider\">|</span>\n {% endif %}\n ```\n\n### 12. next6 开启标签和分类\n\n- 12.1 创建tags相关目录\n```\nhexo new page tags\nhexo new page categories\n```\n\n- 12.2 开启tags标签和分类\n```\nvim themes/next/_config.yml\ntags: /tags/ || tags\ncategories: /categories/ || th\n```\n\n- 12.3 修改tags站点文件\n```\ncat source/tags/index.md\n---\ntitle: tags\ndate: 2019-09-24 10:08:59\ntype: \"tags\"\nlayout: \"tags\"\ncomments: false\n---\n```\n\n- 12.4 修改categories站点文件\n```\ncat source/categories/index.md\n---\ntitle: categories\ndate: 2019-09-24 10:09:55\ntype: \"categories\"\nlayout: \"categories\"\ncomments: false\n---\n```\n\n- 12.5 去掉xxx.github.io/tags/ 页面的post-title(因为我的这个css左对齐了,默认是居中,所以很丑)\n```\n# 注释下面这段代码\nvim themes/nextv/layout/page.swig \n<!-- {% include '_partials/page/page-header.swig' %} -->\n```\n","source":"_posts/首次搭建hexo博客系统.md","raw":"---\ntitle: 首次搭建hexo博客系统\ndate: 2019-09-19 17:24:53\ncopyright: true\ntags:\n  - hexo6\n  - hexo美化\ncategories: \n  - 技术文档\n  - 博客\n\ntop: 10\n---\n### 1 安装hexo\n- 1.1 在mac上安装\n```\n# 安装node\nbrew install node npm\n```\n <!-- more -->\n\n- 1.2 在linux安装\n```\n# 安装node10\ncurl -sL https://rpm.nodesource.com/setup_10.x | bash -\nyum install -y nodejs\n```\n\n- 1.3 安装hexo\n```\n# 安装hexo\nnpm install -g hexo\n```\n\n\n### 2 初始化\n```\ncd /data/github/\n# 初始化\n\nhexo init blog\n# 框架安装\nnpm install\n\n#安装 Hexo 关于启动服务器的插件\nnpm install hexo-server --save\n\n# 启动服务器, 本地查看效果, 如果不指定端口，默认为4000\nhexo server\n\n```\n\n### 3 主题和配置\n- 下载主题：[https://github.com/theme-next/hexo-theme-next](https://github.com/theme-next/hexo-theme-next)\n```\nunzip hexo-theme-next-master.zip\nmv hexo-theme-next-master $blog/themes/\n```\n\n- 修改主题配置 _config.yml 中的其他属性\n```\ntitle: Zhangzhiwei's Blog\n...\ntheme: hexo-theme-next\n...\nscheme: Mist\n```\n\n### 4. 编写更新博客\n\n- 创建博客\n```\nhexo new '第一个博客'\n```\n\n- cat source/_posts/第一个博客.md\n```\ntitle: 第一个博客\ndate: 2019-09-19 16:58:01\ntags:\n  - hexo\ncategories:\n  - hexo学习\n```\n\n- github 创建一个Repository仓库\n```\n1. 仓库名字必须是 xxx.github.io\n2. 在settings中 勾选Template repository\n3. 记得添加自己的ssh\n```\n\n\n\n- github配置\n```\n # 安装 hexo 关于 git 的组件\nnpm install hexo-deployer-git --save\n```\n\n- 在_config.yml 中为 git 添加配置\n```\ndeploy:\n  type: git\n  repository: git@github.com:*/*.github.io.git\n  branch: master\n```\n\n- 查看是否能提交代码github\n```\nssh -T -ai ~/.ssh/id_rsa git@github.com\n```\n\n- 部署\n```\nhexo g\nhexo d\n或者\nhexo d -g\n```\n\n### 5. next6让首页文字预览显示\n```\n1. 找到主题的配置文件(themes/hexo-theme-next/_config.yml)\n2. 修改auto_excerpt,把enable改为对应的false改为true\n3. hexo d -g\n```\n\n### 6. next6添加搜索功能\n```\n1. npm install hexo-generator-searchdb --save\n2. 全局配置文件_config.yml\nsearch:\n  path: search.xml\n  field: post\n  format: html\n  limit: 10000\n3. 修改主题的_config.yml\nlocal_search:\n  enable: true\n```\n\n### 7. next6 Mist字体的 首页文章间距和首页页宽,字体\n- 7.1 首页文章间距\n\n\t```\n\t增加一些内容: source/css/_schemes/Mist/_posts-expanded.styl\n\t.posts-expand .post {\n\t  margin-top: 30px;\n\t  margin-bottom: 30px;\n\t}\n\t\n\t```\n\n- 7.2 页宽\n\n\t```\n\tsource/css/_variables/base.styl\n\t$content-desktop                = 900px\n\t$content-desktop-large          = 1000px\n\t$content-desktop-largest        = 1100px\n\t```\n\n- 7.3 字体大小\n\n```\nthemes/next/source/css/_variables/base.styl\n\n$font-size-base           = 0.95em;\n$font-size-base           = unit(hexo-config('font.global.size'), em) if hexo-config('font.global.size') is a 'unit';\n$font-size-smallest       = .75em;\n$font-size-smaller        = .8125em;\n$font-size-small          = .855em;\n$font-size-medium         = 0.95em;\n$font-size-large          = 0.975em;\n$font-size-larger         = 1.em;\n$font-size-largest        = 1.125em;\n```\n\n### 8. 添加网格\n-  8.1 自定义方式修改\n\n\t```\n\t# 新创建自定义文件\n\tcat themes/next/source/css/_custom/custom.styl\n\t// 主页文章添加阴影效果\n\t.post {\n\tmargin-top: 60px;\n\tmargin-bottom: 60px;\n\tpadding: 25px;\n\t-webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);\n\t-moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);\n\t}\n\n\t# 修改config文件\n\tvim ./themes/next/_config.yml\n\tcustom: custom\n\t```\n\n- 8.2 next6版本修改方式\n\t> 参考: [hexo6--next美化整理](https://www.jianshu.com/p/ec2e6c8a1d89)\n\n\t1. 修改 themes/next/layout/_layout.swig\n\t```\n\t{% if theme.canvas_nest %}\n\t<script type=\"text/javascript\" src=\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\">\n\t</script>\n\t{% endif %}\n\t```\n\n\t> 将上述代码防止在< /body> 前就可以了(注意不要放在< /head>的后面)。\n\n\t2. 修改主题的_config.yml\n\n\t```\n\tcanvas_nest: true\n\n\t//color: 线条颜色, 默认: '0,0,0'；三个数字分别为(R,G,B)\n\t//opacity: 线条透明度（0~1）, 默认: 0.5\n\t//count: 线条的总数量, 默认: 150\n\t//zIndex: 背景的z-index属性，css属性用于控制所在层的位置, 默认: -1\n\t```\n> 注意:\n我这里打开提示缺少 canvas-nest.min.js文件,这里是手动copy的一份写到 source/lib/canvas-nest/canvas-nest.min.js\n\n```\n!function(){function o(w,v,i){return w.getAttribute(v)||i}function j(i){return document.getElementsByTagName(i)}function l(){var i=j(\"script\"),w=i.length,v=i[w-1];return{l:w,z:o(v,\"zIndex\",-1),o:o(v,\"opacity\",0.5),c:o(v,\"color\",\"0,0,0\"),n:o(v,\"count\",99)}}function k(){r=u.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=u.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function b(){e.clearRect(0,0,r,n);var w=[f].concat(t);var x,v,A,B,z,y;t.forEach(function(i){i.x+=i.xa,i.y+=i.ya,i.xa*=i.x>r||i.x<0?-1:1,i.ya*=i.y>n||i.y<0?-1:1,e.fillRect(i.x-0.5,i.y-0.5,1,1);for(v=0;v<w.length;v++){x=w[v];if(i!==x&&null!==x.x&&null!==x.y){B=i.x-x.x,z=i.y-x.y,y=B*B+z*z;y<x.max&&(x===f&&y>=x.max/2&&(i.x-=0.03*B,i.y-=0.03*z),A=(x.max-y)/x.max,e.beginPath(),e.lineWidth=A/2,e.strokeStyle=\"rgba(\"+s.c+\",\"+(A+0.2)+\")\",e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.stroke())}}w.splice(w.indexOf(i),1)}),m(b)}var u=document.createElement(\"canvas\"),s=l(),c=\"c_n\"+s.l,e=u.getContext(\"2d\"),r,n,m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){window.setTimeout(i,1000/45)},a=Math.random,f={x:null,y:null,max:20000};u.id=c;u.style.cssText=\"position:fixed;top:0;left:0;z-index:\"+s.z+\";opacity:\"+s.o;j(\"body\")[0].appendChild(u);k(),window.onresize=k;window.onmousemove=function(i){i=i||window.event,f.x=i.clientX,f.y=i.clientY},window.onmouseout=function(){f.x=null,f.y=null};for(var t=[],p=0;s.n>p;p++){var h=a()*r,g=a()*n,q=2*a()-1,d=2*a()-1;t.push({x:h,y:g,xa:q,ya:d,max:6000})}setTimeout(function(){b()},100)}();%                                                                                                    zhangzw@MacBook-Pro  /data/github/blog   master ● \n```\n\n### 9. 添加评论功能\n\n- 9.1 注册leancloud\n ```\n 注册-> 验证邮箱-> 实名认证 -> 设置获取appid和appkey\n ```\n\n- 9.2 修改配置文件\n ```\n valine:\n   enable: true \n   appid: 'appid' \n   appkey: 'appkey' \n   placeholder: \"ヾﾉ≧∀≦)o 来呀！快活呀！~啦啦啦~ 啦啦啦啦~\" \n   visitor: true //这个打开页会统计文章阅读数\n ```\n\n\n\n\n### 10. next6添加字数统计 和阅读时长\n\n> [hexo-symbols-count-time](https://github.com/theme-next/hexo-symbols-count-time)\n\n- 10.1 安装node扩展\n ```\n npm install hexo-symbols-count-time --save\n ```\n\n- 10.2 修改全局配置 _config.yml\n ```\n symbols_count_time:\n   symbols: true\n   time: true\n   total_symbols: true\n   total_time: true\n   exclude_codeblock: false\n ```\n\n- 10.3 修改主题配置 _config.yml\n ```\n symbols_count_time:\n   separated_meta: true\n   item_text_post: true\n   item_text_total: false\n   awl: 4\n   wpm: 275\n   suffix: mins.\n ```\n\n\n\n### 11. next6 文章置顶功能\n\n- 11.1 安装node扩展 \n ```\n npm uninstall hexo-generator-index --save\n npm install hexo-generator-index-pin-top --save\n ```\n\n- 11.2 在文章开头添加置顶标识\n ```\n top: 10\n ```\n\n- 11.3 首页添加明显置顶标识\n ```\n themes/next/layout/_macro/post.swig 在<div class=\"post-meta\"> 下添加如下代码\n {% if post.top %}\n     <i class=\"fa fa-thumb-tack\"></i>\n     <font color=green>置顶</font>\n     <span class=\"post-meta-divider\">|</span>\n {% endif %}\n ```\n\n### 12. next6 开启标签和分类\n\n- 12.1 创建tags相关目录\n```\nhexo new page tags\nhexo new page categories\n```\n\n- 12.2 开启tags标签和分类\n```\nvim themes/next/_config.yml\ntags: /tags/ || tags\ncategories: /categories/ || th\n```\n\n- 12.3 修改tags站点文件\n```\ncat source/tags/index.md\n---\ntitle: tags\ndate: 2019-09-24 10:08:59\ntype: \"tags\"\nlayout: \"tags\"\ncomments: false\n---\n```\n\n- 12.4 修改categories站点文件\n```\ncat source/categories/index.md\n---\ntitle: categories\ndate: 2019-09-24 10:09:55\ntype: \"categories\"\nlayout: \"categories\"\ncomments: false\n---\n```\n\n- 12.5 去掉xxx.github.io/tags/ 页面的post-title(因为我的这个css左对齐了,默认是居中,所以很丑)\n```\n# 注释下面这段代码\nvim themes/nextv/layout/page.swig \n<!-- {% include '_partials/page/page-header.swig' %} -->\n```\n","slug":"首次搭建hexo博客系统","published":1,"updated":"2019-09-24T02:40:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck0x8fst3000a7g9ko6hobcsz","content":"<h3 id=\"1-安装hexo\"><a href=\"#1-安装hexo\" class=\"headerlink\" title=\"1 安装hexo\"></a>1 安装hexo</h3><ul>\n<li><p>1.1 在mac上安装</p>\n<figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装node</span></span><br><span class=\"line\">brew install <span class=\"keyword\">node</span> <span class=\"title\">npm</span></span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n</li>\n<li><p>1.2 在linux安装</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装node10</span></span><br><span class=\"line\"><span class=\"attribute\">curl</span> -sL https://rpm.nodesource.com/setup_10.x | bash -</span><br><span class=\"line\">yum install -y nodejs</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>1.3 安装hexo</p>\n<figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装hexo</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> -g hexo</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"2-初始化\"><a href=\"#2-初始化\" class=\"headerlink\" title=\"2 初始化\"></a>2 初始化</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /data/github/</span><br><span class=\"line\"><span class=\"comment\"># 初始化</span></span><br><span class=\"line\"></span><br><span class=\"line\">hexo init blog</span><br><span class=\"line\"><span class=\"comment\"># 框架安装</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#安装 Hexo 关于启动服务器的插件</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-<span class=\"keyword\">server</span> <span class=\"comment\">--save</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 启动服务器, 本地查看效果, 如果不指定端口，默认为4000</span></span><br><span class=\"line\">hexo <span class=\"keyword\">server</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-主题和配置\"><a href=\"#3-主题和配置\" class=\"headerlink\" title=\"3 主题和配置\"></a>3 主题和配置</h3><ul>\n<li><p>下载主题：<a href=\"https://github.com/theme-next/hexo-theme-next\" target=\"_blank\" rel=\"noopener\">https://github.com/theme-next/hexo-theme-next</a></p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unzip hexo-theme-<span class=\"keyword\">next</span>-master.zip</span><br><span class=\"line\">mv hexo-theme-<span class=\"keyword\">next</span>-master <span class=\"variable\">$blog</span><span class=\"regexp\">/themes/</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改主题配置 _config.yml 中的其他属性</p>\n<figure class=\"highlight ldif\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">title</span>: Zhangzhiwei's Blog</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"attribute\">theme</span>: hexo-theme-next</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"attribute\">scheme</span>: Mist</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"4-编写更新博客\"><a href=\"#4-编写更新博客\" class=\"headerlink\" title=\"4. 编写更新博客\"></a>4. 编写更新博客</h3><ul>\n<li><p>创建博客</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> <span class=\"string\">'第一个博客'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>cat source/_posts/第一个博客.md</p>\n<figure class=\"highlight subunit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: 第一个博客</span><br><span class=\"line\">date: 2019<span class=\"string\">-09</span><span class=\"string\">-19</span> 16:58:01</span><br><span class=\"line\"><span class=\"keyword\">tags:</span></span><br><span class=\"line\">  - hexo</span><br><span class=\"line\">categories:</span><br><span class=\"line\">  - hexo学习</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>github 创建一个Repository仓库</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1. </span>仓库名字必须是 xxx.github.io</span><br><span class=\"line\"><span class=\"bullet\">2. </span>在settings中 勾选Template repository</span><br><span class=\"line\"><span class=\"bullet\">3. </span>记得添加自己的ssh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>github配置</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\"># 安装 hexo 关于 git 的组件</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-deployer-git <span class=\"comment\">--save</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在_config.yml 中为 git 添加配置</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">deploy</span>:</span><br><span class=\"line\">  <span class=\"attribute\">type</span>: git</span><br><span class=\"line\">  <span class=\"attribute\">repository</span>: git<span class=\"variable\">@github</span>.<span class=\"attribute\">com</span>:*<span class=\"comment\">/*.github.io.git</span></span><br><span class=\"line\"><span class=\"comment\">  branch: master</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查看是否能提交代码github</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -T -ai ~<span class=\"regexp\">/.ssh/id</span>_rsa git<span class=\"variable\">@github</span>.com</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>部署</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">hexo</span> g</span><br><span class=\"line\">hexo d</span><br><span class=\"line\">或者</span><br><span class=\"line\">hexo d -g</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"5-next6让首页文字预览显示\"><a href=\"#5-next6让首页文字预览显示\" class=\"headerlink\" title=\"5. next6让首页文字预览显示\"></a>5. next6让首页文字预览显示</h3><figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> 找到主题的配置文件(themes/hexo-theme-<span class=\"keyword\">next</span>/_config.yml)</span><br><span class=\"line\"><span class=\"number\">2.</span> 修改auto_excerpt,把enable改为对应的<span class=\"literal\">false</span>改为<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"number\">3.</span> hexo d -g</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-next6添加搜索功能\"><a href=\"#6-next6添加搜索功能\" class=\"headerlink\" title=\"6. next6添加搜索功能\"></a>6. next6添加搜索功能</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. npm <span class=\"keyword\">install</span> hexo-generator-searchdb <span class=\"comment\">--save</span></span><br><span class=\"line\"><span class=\"number\">2.</span> 全局配置文件_config.yml</span><br><span class=\"line\"><span class=\"keyword\">search</span>:</span><br><span class=\"line\">  <span class=\"keyword\">path</span>: search.xml</span><br><span class=\"line\">  <span class=\"keyword\">field</span>: post</span><br><span class=\"line\">  <span class=\"keyword\">format</span>: html</span><br><span class=\"line\">  <span class=\"keyword\">limit</span>: <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"number\">3.</span> 修改主题的_config.yml</span><br><span class=\"line\">local_search:</span><br><span class=\"line\">  <span class=\"keyword\">enable</span>: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7-next6-Mist字体的-首页文章间距和首页页宽-字体\"><a href=\"#7-next6-Mist字体的-首页文章间距和首页页宽-字体\" class=\"headerlink\" title=\"7. next6 Mist字体的 首页文章间距和首页页宽,字体\"></a>7. next6 Mist字体的 首页文章间距和首页页宽,字体</h3><ul>\n<li><p>7.1 首页文章间距</p>\n  <figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">增加一些内容: source/css/_schemes/Mist/_posts-expanded.styl</span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">30px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">30px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>7.2 页宽</p>\n  <figure class=\"highlight gams\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source/css/_variables/base.styl</span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta-keyword\">$content</span>-desktop                = 900px</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta-keyword\">$content</span>-desktop-large          = 1000px</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta-keyword\">$content</span>-desktop-largest        = 1100px</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>7.3 字体大小</p>\n</li>\n</ul>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">themes/next/<span class=\"keyword\">source</span>/css/_variables/base.styl</span><br><span class=\"line\"></span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-base           = <span class=\"number\">0.95</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-base           = <span class=\"keyword\">unit</span>(hexo-config(<span class=\"string\">'font.global.size'</span>), em) <span class=\"keyword\">if</span> hexo-config(<span class=\"string\">'font.global.size'</span>) is a <span class=\"string\">'unit'</span>;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-smallest       = <span class=\"number\">.75</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-smaller        = <span class=\"number\">.8125</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-small          = <span class=\"number\">.855</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-medium         = <span class=\"number\">0.95</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-large          = <span class=\"number\">0.975</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-larger         = <span class=\"number\">1.</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-largest        = <span class=\"number\">1.125</span>em;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"8-添加网格\"><a href=\"#8-添加网格\" class=\"headerlink\" title=\"8. 添加网格\"></a>8. 添加网格</h3><ul>\n<li><p>8.1 自定义方式修改</p>\n <figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># 新创建自定义文件</span></span><br><span class=\"line\">cat themes<span class=\"meta-keyword\">/next/</span>source<span class=\"meta-keyword\">/css/</span>_custom/custom.styl</span><br><span class=\"line\"><span class=\"comment\">// 主页文章添加阴影效果</span></span><br><span class=\"line\">.<span class=\"class\">post </span>&#123;</span><br><span class=\"line\">margin-top: <span class=\"number\">60</span>px;</span><br><span class=\"line\">margin-bottom: <span class=\"number\">60</span>px;</span><br><span class=\"line\"><span class=\"symbol\">padding:</span> <span class=\"number\">25</span>px;</span><br><span class=\"line\">-webkit-box-shadow: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5</span>px rgba(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">203</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">-moz-box-shadow: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5</span>px rgba(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">204</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># 修改config文件</span></span><br><span class=\"line\">vim .<span class=\"meta-keyword\">/themes/</span>next/_config.yml</span><br><span class=\"line\"><span class=\"symbol\">custom:</span> custom</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>8.2 next6版本修改方式</p>\n<blockquote>\n<p>参考: <a href=\"https://www.jianshu.com/p/ec2e6c8a1d89\" target=\"_blank\" rel=\"noopener\">hexo6–next美化整理</a></p>\n</blockquote>\n<ol>\n<li><p>修改 themes/next/layout/_layout.swig</p>\n<figure class=\"highlight django\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">if</span></span> theme.canvas_nest %&#125;</span><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\"</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">endif</span></span> %&#125;</span><span class=\"xml\"></span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>将上述代码防止在&lt; /body&gt; 前就可以了(注意不要放在&lt; /head&gt;的后面)。</p>\n</blockquote>\n</li>\n<li><p>修改主题的_config.yml</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">canvas_nest</span>: true</span><br><span class=\"line\"></span><br><span class=\"line\">//color: 线条颜色, 默认: '0,0,0'；三个数字分别为(R,G,B)</span><br><span class=\"line\">//opacity: 线条透明度（0~1）, 默认: 0.5</span><br><span class=\"line\">//count: 线条的总数量, 默认: 150</span><br><span class=\"line\">//zIndex: 背景的z-index属性，css属性用于控制所在层的位置, 默认: -1</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n</li>\n</ul>\n<blockquote>\n<p>注意:<br>我这里打开提示缺少 canvas-nest.min.js文件,这里是手动copy的一份写到 source/lib/canvas-nest/canvas-nest.min.js</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">o</span>(<span class=\"params\">w,v,i</span>)</span>&#123;<span class=\"keyword\">return</span> w.getAttribute(v)||i&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">j</span>(<span class=\"params\">i</span>)</span>&#123;<span class=\"keyword\">return</span> <span class=\"built_in\">document</span>.getElementsByTagName(i)&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">l</span>(<span class=\"params\"></span>)</span>&#123;<span class=\"keyword\">var</span> i=j(<span class=\"string\">\"script\"</span>),w=i.length,v=i[w<span class=\"number\">-1</span>];<span class=\"keyword\">return</span>&#123;<span class=\"attr\">l</span>:w,<span class=\"attr\">z</span>:o(v,<span class=\"string\">\"zIndex\"</span>,<span class=\"number\">-1</span>),<span class=\"attr\">o</span>:o(v,<span class=\"string\">\"opacity\"</span>,<span class=\"number\">0.5</span>),<span class=\"attr\">c</span>:o(v,<span class=\"string\">\"color\"</span>,<span class=\"string\">\"0,0,0\"</span>),<span class=\"attr\">n</span>:o(v,<span class=\"string\">\"count\"</span>,<span class=\"number\">99</span>)&#125;&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">k</span>(<span class=\"params\"></span>)</span>&#123;r=u.width=<span class=\"built_in\">window</span>.innerWidth||<span class=\"built_in\">document</span>.documentElement.clientWidth||<span class=\"built_in\">document</span>.body.clientWidth,n=u.height=<span class=\"built_in\">window</span>.innerHeight||<span class=\"built_in\">document</span>.documentElement.clientHeight||<span class=\"built_in\">document</span>.body.clientHeight&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">b</span>(<span class=\"params\"></span>)</span>&#123;e.clearRect(<span class=\"number\">0</span>,<span class=\"number\">0</span>,r,n);<span class=\"keyword\">var</span> w=[f].concat(t);<span class=\"keyword\">var</span> x,v,A,B,z,y;t.forEach(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">i</span>)</span>&#123;i.x+=i.xa,i.y+=i.ya,i.xa*=i.x&gt;r||i.x&lt;<span class=\"number\">0</span>?<span class=\"number\">-1</span>:<span class=\"number\">1</span>,i.ya*=i.y&gt;n||i.y&lt;<span class=\"number\">0</span>?<span class=\"number\">-1</span>:<span class=\"number\">1</span>,e.fillRect(i.x<span class=\"number\">-0.5</span>,i.y<span class=\"number\">-0.5</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>);<span class=\"keyword\">for</span>(v=<span class=\"number\">0</span>;v&lt;w.length;v++)&#123;x=w[v];<span class=\"keyword\">if</span>(i!==x&amp;&amp;<span class=\"literal\">null</span>!==x.x&amp;&amp;<span class=\"literal\">null</span>!==x.y)&#123;B=i.x-x.x,z=i.y-x.y,y=B*B+z*z;y&lt;x.max&amp;&amp;(x===f&amp;&amp;y&gt;=x.max/<span class=\"number\">2</span>&amp;&amp;(i.x-=<span class=\"number\">0.03</span>*B,i.y-=<span class=\"number\">0.03</span>*z),A=(x.max-y)/x.max,e.beginPath(),e.lineWidth=A/<span class=\"number\">2</span>,e.strokeStyle=<span class=\"string\">\"rgba(\"</span>+s.c+<span class=\"string\">\",\"</span>+(A+<span class=\"number\">0.2</span>)+<span class=\"string\">\")\"</span>,e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.stroke())&#125;&#125;w.splice(w.indexOf(i),<span class=\"number\">1</span>)&#125;),m(b)&#125;<span class=\"keyword\">var</span> u=<span class=\"built_in\">document</span>.createElement(<span class=\"string\">\"canvas\"</span>),s=l(),c=<span class=\"string\">\"c_n\"</span>+s.l,e=u.getContext(<span class=\"string\">\"2d\"</span>),r,n,m=<span class=\"built_in\">window</span>.requestAnimationFrame||<span class=\"built_in\">window</span>.webkitRequestAnimationFrame||<span class=\"built_in\">window</span>.mozRequestAnimationFrame||<span class=\"built_in\">window</span>.oRequestAnimationFrame||<span class=\"built_in\">window</span>.msRequestAnimationFrame||<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">i</span>)</span>&#123;<span class=\"built_in\">window</span>.setTimeout(i,<span class=\"number\">1000</span>/<span class=\"number\">45</span>)&#125;,a=<span class=\"built_in\">Math</span>.random,f=&#123;<span class=\"attr\">x</span>:<span class=\"literal\">null</span>,<span class=\"attr\">y</span>:<span class=\"literal\">null</span>,<span class=\"attr\">max</span>:<span class=\"number\">20000</span>&#125;;u.id=c;u.style.cssText=<span class=\"string\">\"position:fixed;top:0;left:0;z-index:\"</span>+s.z+<span class=\"string\">\";opacity:\"</span>+s.o;j(<span class=\"string\">\"body\"</span>)[<span class=\"number\">0</span>].appendChild(u);k(),<span class=\"built_in\">window</span>.onresize=k;<span class=\"built_in\">window</span>.onmousemove=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">i</span>)</span>&#123;i=i||<span class=\"built_in\">window</span>.event,f.x=i.clientX,f.y=i.clientY&#125;,<span class=\"built_in\">window</span>.onmouseout=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;f.x=<span class=\"literal\">null</span>,f.y=<span class=\"literal\">null</span>&#125;;<span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> t=[],p=<span class=\"number\">0</span>;s.n&gt;p;p++)&#123;<span class=\"keyword\">var</span> h=a()*r,g=a()*n,q=<span class=\"number\">2</span>*a()<span class=\"number\">-1</span>,d=<span class=\"number\">2</span>*a()<span class=\"number\">-1</span>;t.push(&#123;<span class=\"attr\">x</span>:h,<span class=\"attr\">y</span>:g,<span class=\"attr\">xa</span>:q,<span class=\"attr\">ya</span>:d,<span class=\"attr\">max</span>:<span class=\"number\">6000</span>&#125;)&#125;setTimeout(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;b()&#125;,<span class=\"number\">100</span>)&#125;();%                                                                                                    zhangzw@MacBook-Pro  /data/github/blog   master ● </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9-添加评论功能\"><a href=\"#9-添加评论功能\" class=\"headerlink\" title=\"9. 添加评论功能\"></a>9. 添加评论功能</h3><ul>\n<li><p>9.1 注册leancloud</p>\n<figure class=\"highlight clean\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">注册-&gt; 验证邮箱-&gt; 实名认证 -&gt; 设置获取appid和appkey</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>9.2 修改配置文件</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">valine</span>:</span><br><span class=\"line\">  <span class=\"attribute\">enable</span>: true </span><br><span class=\"line\">  <span class=\"attribute\">appid</span>: <span class=\"string\">'appid'</span> </span><br><span class=\"line\">  <span class=\"attribute\">appkey</span>: <span class=\"string\">'appkey'</span> </span><br><span class=\"line\">  <span class=\"attribute\">placeholder</span>: <span class=\"string\">\"ヾﾉ≧∀≦)o 来呀！快活呀！~啦啦啦~ 啦啦啦啦~\"</span> </span><br><span class=\"line\">  <span class=\"attribute\">visitor</span>: true <span class=\"comment\">//这个打开页会统计文章阅读数</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"10-next6添加字数统计-和阅读时长\"><a href=\"#10-next6添加字数统计-和阅读时长\" class=\"headerlink\" title=\"10. next6添加字数统计 和阅读时长\"></a>10. next6添加字数统计 和阅读时长</h3><blockquote>\n<p><a href=\"https://github.com/theme-next/hexo-symbols-count-time\" target=\"_blank\" rel=\"noopener\">hexo-symbols-count-time</a></p>\n</blockquote>\n<ul>\n<li><p>10.1 安装node扩展</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-symbols-<span class=\"keyword\">count</span>-<span class=\"built_in\">time</span> <span class=\"comment\">--save</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>10.2 修改全局配置 _config.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"><span class=\"attr\">  symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  exclude_codeblock:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>10.3 修改主题配置 _config.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"><span class=\"attr\">  separated_meta:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  item_text_post:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  item_text_total:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  awl:</span> <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"attr\">  wpm:</span> <span class=\"number\">275</span></span><br><span class=\"line\"><span class=\"attr\">  suffix:</span> <span class=\"string\">mins.</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"11-next6-文章置顶功能\"><a href=\"#11-next6-文章置顶功能\" class=\"headerlink\" title=\"11. next6 文章置顶功能\"></a>11. next6 文章置顶功能</h3><ul>\n<li><p>11.1 安装node扩展 </p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm <span class=\"keyword\">uninstall</span> hexo-generator-<span class=\"keyword\">index</span> <span class=\"comment\">--save</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-generator-<span class=\"keyword\">index</span>-pin-top <span class=\"comment\">--save</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>11.2 在文章开头添加置顶标识</p>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">top:</span> <span class=\"number\">10</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>11.3 首页添加明显置顶标识</p>\n<figure class=\"highlight django\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\">themes/next/layout/_macro/post.swig 在<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta\"</span>&gt;</span> 下添加如下代码</span></span><br><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">if</span></span> post.top %&#125;</span><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-thumb-tack\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">font</span> <span class=\"attr\">color</span>=<span class=\"string\">green</span>&gt;</span>置顶<span class=\"tag\">&lt;/<span class=\"name\">font</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-divider\"</span>&gt;</span>|<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">endif</span></span> %&#125;</span><span class=\"xml\"></span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"12-next6-开启标签和分类\"><a href=\"#12-next6-开启标签和分类\" class=\"headerlink\" title=\"12. next6 开启标签和分类\"></a>12. next6 开启标签和分类</h3><ul>\n<li><p>12.1 创建tags相关目录</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new<span class=\"built_in\"> page </span>tags</span><br><span class=\"line\">hexo new<span class=\"built_in\"> page </span>categories</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.2 开启tags标签和分类</p>\n<figure class=\"highlight subunit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim themes/next/_config.yml</span><br><span class=\"line\"><span class=\"keyword\">tags:</span> /tags/ || tags</span><br><span class=\"line\">categories: /categories/ || th</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.3 修改tags站点文件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cat</span> <span class=\"string\">source/tags/index.md</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">tags</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">2019</span><span class=\"bullet\">-09</span><span class=\"bullet\">-24</span> <span class=\"number\">10</span><span class=\"string\">:08:59</span></span><br><span class=\"line\"><span class=\"attr\">type:</span> <span class=\"string\">\"tags\"</span></span><br><span class=\"line\"><span class=\"attr\">layout:</span> <span class=\"string\">\"tags\"</span></span><br><span class=\"line\"><span class=\"attr\">comments:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.4 修改categories站点文件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cat</span> <span class=\"string\">source/categories/index.md</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">categories</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">2019</span><span class=\"bullet\">-09</span><span class=\"bullet\">-24</span> <span class=\"number\">10</span><span class=\"string\">:09:55</span></span><br><span class=\"line\"><span class=\"attr\">type:</span> <span class=\"string\">\"categories\"</span></span><br><span class=\"line\"><span class=\"attr\">layout:</span> <span class=\"string\">\"categories\"</span></span><br><span class=\"line\"><span class=\"attr\">comments:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.5 去掉xxx.github.io/tags/ 页面的post-title(因为我的这个css左对齐了,默认是居中,所以很丑)</p>\n<figure class=\"highlight django\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"># 注释下面这段代码</span></span><br><span class=\"line\"><span class=\"xml\">vim themes/nextv/layout/page.swig </span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"comment\">&lt;!-- </span></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">include</span></span> '_partials/page/page-header.swig' %&#125;</span><span class=\"xml\"><span class=\"comment\"> --&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n","site":{"data":{}},"length":6869,"excerpt":"<h3 id=\"1-安装hexo\"><a href=\"#1-安装hexo\" class=\"headerlink\" title=\"1 安装hexo\"></a>1 安装hexo</h3><ul>\n<li><p>1.1 在mac上安装</p>\n<figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装node</span></span><br><span class=\"line\">brew install <span class=\"keyword\">node</span> <span class=\"title\">npm</span></span><br></pre></td></tr></table></figure>","more":"</li>\n<li><p>1.2 在linux安装</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装node10</span></span><br><span class=\"line\"><span class=\"attribute\">curl</span> -sL https://rpm.nodesource.com/setup_10.x | bash -</span><br><span class=\"line\">yum install -y nodejs</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>1.3 安装hexo</p>\n<figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装hexo</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> -g hexo</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"2-初始化\"><a href=\"#2-初始化\" class=\"headerlink\" title=\"2 初始化\"></a>2 初始化</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /data/github/</span><br><span class=\"line\"><span class=\"comment\"># 初始化</span></span><br><span class=\"line\"></span><br><span class=\"line\">hexo init blog</span><br><span class=\"line\"><span class=\"comment\"># 框架安装</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#安装 Hexo 关于启动服务器的插件</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-<span class=\"keyword\">server</span> <span class=\"comment\">--save</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 启动服务器, 本地查看效果, 如果不指定端口，默认为4000</span></span><br><span class=\"line\">hexo <span class=\"keyword\">server</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-主题和配置\"><a href=\"#3-主题和配置\" class=\"headerlink\" title=\"3 主题和配置\"></a>3 主题和配置</h3><ul>\n<li><p>下载主题：<a href=\"https://github.com/theme-next/hexo-theme-next\" target=\"_blank\" rel=\"noopener\">https://github.com/theme-next/hexo-theme-next</a></p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unzip hexo-theme-<span class=\"keyword\">next</span>-master.zip</span><br><span class=\"line\">mv hexo-theme-<span class=\"keyword\">next</span>-master <span class=\"variable\">$blog</span><span class=\"regexp\">/themes/</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改主题配置 _config.yml 中的其他属性</p>\n<figure class=\"highlight ldif\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">title</span>: Zhangzhiwei's Blog</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"attribute\">theme</span>: hexo-theme-next</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"attribute\">scheme</span>: Mist</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"4-编写更新博客\"><a href=\"#4-编写更新博客\" class=\"headerlink\" title=\"4. 编写更新博客\"></a>4. 编写更新博客</h3><ul>\n<li><p>创建博客</p>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo <span class=\"keyword\">new</span> <span class=\"string\">'第一个博客'</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>cat source/_posts/第一个博客.md</p>\n<figure class=\"highlight subunit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: 第一个博客</span><br><span class=\"line\">date: 2019<span class=\"string\">-09</span><span class=\"string\">-19</span> 16:58:01</span><br><span class=\"line\"><span class=\"keyword\">tags:</span></span><br><span class=\"line\">  - hexo</span><br><span class=\"line\">categories:</span><br><span class=\"line\">  - hexo学习</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>github 创建一个Repository仓库</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1. </span>仓库名字必须是 xxx.github.io</span><br><span class=\"line\"><span class=\"bullet\">2. </span>在settings中 勾选Template repository</span><br><span class=\"line\"><span class=\"bullet\">3. </span>记得添加自己的ssh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>github配置</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\"># 安装 hexo 关于 git 的组件</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-deployer-git <span class=\"comment\">--save</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在_config.yml 中为 git 添加配置</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">deploy</span>:</span><br><span class=\"line\">  <span class=\"attribute\">type</span>: git</span><br><span class=\"line\">  <span class=\"attribute\">repository</span>: git<span class=\"variable\">@github</span>.<span class=\"attribute\">com</span>:*<span class=\"comment\">/*.github.io.git</span></span><br><span class=\"line\"><span class=\"comment\">  branch: master</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查看是否能提交代码github</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -T -ai ~<span class=\"regexp\">/.ssh/id</span>_rsa git<span class=\"variable\">@github</span>.com</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>部署</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">hexo</span> g</span><br><span class=\"line\">hexo d</span><br><span class=\"line\">或者</span><br><span class=\"line\">hexo d -g</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"5-next6让首页文字预览显示\"><a href=\"#5-next6让首页文字预览显示\" class=\"headerlink\" title=\"5. next6让首页文字预览显示\"></a>5. next6让首页文字预览显示</h3><figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> 找到主题的配置文件(themes/hexo-theme-<span class=\"keyword\">next</span>/_config.yml)</span><br><span class=\"line\"><span class=\"number\">2.</span> 修改auto_excerpt,把enable改为对应的<span class=\"literal\">false</span>改为<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"number\">3.</span> hexo d -g</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-next6添加搜索功能\"><a href=\"#6-next6添加搜索功能\" class=\"headerlink\" title=\"6. next6添加搜索功能\"></a>6. next6添加搜索功能</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. npm <span class=\"keyword\">install</span> hexo-generator-searchdb <span class=\"comment\">--save</span></span><br><span class=\"line\"><span class=\"number\">2.</span> 全局配置文件_config.yml</span><br><span class=\"line\"><span class=\"keyword\">search</span>:</span><br><span class=\"line\">  <span class=\"keyword\">path</span>: search.xml</span><br><span class=\"line\">  <span class=\"keyword\">field</span>: post</span><br><span class=\"line\">  <span class=\"keyword\">format</span>: html</span><br><span class=\"line\">  <span class=\"keyword\">limit</span>: <span class=\"number\">10000</span></span><br><span class=\"line\"><span class=\"number\">3.</span> 修改主题的_config.yml</span><br><span class=\"line\">local_search:</span><br><span class=\"line\">  <span class=\"keyword\">enable</span>: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7-next6-Mist字体的-首页文章间距和首页页宽-字体\"><a href=\"#7-next6-Mist字体的-首页文章间距和首页页宽-字体\" class=\"headerlink\" title=\"7. next6 Mist字体的 首页文章间距和首页页宽,字体\"></a>7. next6 Mist字体的 首页文章间距和首页页宽,字体</h3><ul>\n<li><p>7.1 首页文章间距</p>\n  <figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">增加一些内容: source/css/_schemes/Mist/_posts-expanded.styl</span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">30px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">30px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>7.2 页宽</p>\n  <figure class=\"highlight gams\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source/css/_variables/base.styl</span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta-keyword\">$content</span>-desktop                = 900px</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta-keyword\">$content</span>-desktop-large          = 1000px</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta-keyword\">$content</span>-desktop-largest        = 1100px</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>7.3 字体大小</p>\n</li>\n</ul>\n<figure class=\"highlight mel\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">themes/next/<span class=\"keyword\">source</span>/css/_variables/base.styl</span><br><span class=\"line\"></span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-base           = <span class=\"number\">0.95</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-base           = <span class=\"keyword\">unit</span>(hexo-config(<span class=\"string\">'font.global.size'</span>), em) <span class=\"keyword\">if</span> hexo-config(<span class=\"string\">'font.global.size'</span>) is a <span class=\"string\">'unit'</span>;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-smallest       = <span class=\"number\">.75</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-smaller        = <span class=\"number\">.8125</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-small          = <span class=\"number\">.855</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-medium         = <span class=\"number\">0.95</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-large          = <span class=\"number\">0.975</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-larger         = <span class=\"number\">1.</span>em;</span><br><span class=\"line\">$font-<span class=\"keyword\">size</span>-largest        = <span class=\"number\">1.125</span>em;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"8-添加网格\"><a href=\"#8-添加网格\" class=\"headerlink\" title=\"8. 添加网格\"></a>8. 添加网格</h3><ul>\n<li><p>8.1 自定义方式修改</p>\n <figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># 新创建自定义文件</span></span><br><span class=\"line\">cat themes<span class=\"meta-keyword\">/next/</span>source<span class=\"meta-keyword\">/css/</span>_custom/custom.styl</span><br><span class=\"line\"><span class=\"comment\">// 主页文章添加阴影效果</span></span><br><span class=\"line\">.<span class=\"class\">post </span>&#123;</span><br><span class=\"line\">margin-top: <span class=\"number\">60</span>px;</span><br><span class=\"line\">margin-bottom: <span class=\"number\">60</span>px;</span><br><span class=\"line\"><span class=\"symbol\">padding:</span> <span class=\"number\">25</span>px;</span><br><span class=\"line\">-webkit-box-shadow: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5</span>px rgba(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">203</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">-moz-box-shadow: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5</span>px rgba(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">204</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># 修改config文件</span></span><br><span class=\"line\">vim .<span class=\"meta-keyword\">/themes/</span>next/_config.yml</span><br><span class=\"line\"><span class=\"symbol\">custom:</span> custom</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>8.2 next6版本修改方式</p>\n<blockquote>\n<p>参考: <a href=\"https://www.jianshu.com/p/ec2e6c8a1d89\" target=\"_blank\" rel=\"noopener\">hexo6–next美化整理</a></p>\n</blockquote>\n<ol>\n<li><p>修改 themes/next/layout/_layout.swig</p>\n<figure class=\"highlight django\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">if</span></span> theme.canvas_nest %&#125;</span><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\"</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">endif</span></span> %&#125;</span><span class=\"xml\"></span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>将上述代码防止在&lt; /body&gt; 前就可以了(注意不要放在&lt; /head&gt;的后面)。</p>\n</blockquote>\n</li>\n<li><p>修改主题的_config.yml</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">canvas_nest</span>: true</span><br><span class=\"line\"></span><br><span class=\"line\">//color: 线条颜色, 默认: '0,0,0'；三个数字分别为(R,G,B)</span><br><span class=\"line\">//opacity: 线条透明度（0~1）, 默认: 0.5</span><br><span class=\"line\">//count: 线条的总数量, 默认: 150</span><br><span class=\"line\">//zIndex: 背景的z-index属性，css属性用于控制所在层的位置, 默认: -1</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n</li>\n</ul>\n<blockquote>\n<p>注意:<br>我这里打开提示缺少 canvas-nest.min.js文件,这里是手动copy的一份写到 source/lib/canvas-nest/canvas-nest.min.js</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">o</span>(<span class=\"params\">w,v,i</span>)</span>&#123;<span class=\"keyword\">return</span> w.getAttribute(v)||i&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">j</span>(<span class=\"params\">i</span>)</span>&#123;<span class=\"keyword\">return</span> <span class=\"built_in\">document</span>.getElementsByTagName(i)&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">l</span>(<span class=\"params\"></span>)</span>&#123;<span class=\"keyword\">var</span> i=j(<span class=\"string\">\"script\"</span>),w=i.length,v=i[w<span class=\"number\">-1</span>];<span class=\"keyword\">return</span>&#123;<span class=\"attr\">l</span>:w,<span class=\"attr\">z</span>:o(v,<span class=\"string\">\"zIndex\"</span>,<span class=\"number\">-1</span>),<span class=\"attr\">o</span>:o(v,<span class=\"string\">\"opacity\"</span>,<span class=\"number\">0.5</span>),<span class=\"attr\">c</span>:o(v,<span class=\"string\">\"color\"</span>,<span class=\"string\">\"0,0,0\"</span>),<span class=\"attr\">n</span>:o(v,<span class=\"string\">\"count\"</span>,<span class=\"number\">99</span>)&#125;&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">k</span>(<span class=\"params\"></span>)</span>&#123;r=u.width=<span class=\"built_in\">window</span>.innerWidth||<span class=\"built_in\">document</span>.documentElement.clientWidth||<span class=\"built_in\">document</span>.body.clientWidth,n=u.height=<span class=\"built_in\">window</span>.innerHeight||<span class=\"built_in\">document</span>.documentElement.clientHeight||<span class=\"built_in\">document</span>.body.clientHeight&#125;<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">b</span>(<span class=\"params\"></span>)</span>&#123;e.clearRect(<span class=\"number\">0</span>,<span class=\"number\">0</span>,r,n);<span class=\"keyword\">var</span> w=[f].concat(t);<span class=\"keyword\">var</span> x,v,A,B,z,y;t.forEach(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">i</span>)</span>&#123;i.x+=i.xa,i.y+=i.ya,i.xa*=i.x&gt;r||i.x&lt;<span class=\"number\">0</span>?<span class=\"number\">-1</span>:<span class=\"number\">1</span>,i.ya*=i.y&gt;n||i.y&lt;<span class=\"number\">0</span>?<span class=\"number\">-1</span>:<span class=\"number\">1</span>,e.fillRect(i.x<span class=\"number\">-0.5</span>,i.y<span class=\"number\">-0.5</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>);<span class=\"keyword\">for</span>(v=<span class=\"number\">0</span>;v&lt;w.length;v++)&#123;x=w[v];<span class=\"keyword\">if</span>(i!==x&amp;&amp;<span class=\"literal\">null</span>!==x.x&amp;&amp;<span class=\"literal\">null</span>!==x.y)&#123;B=i.x-x.x,z=i.y-x.y,y=B*B+z*z;y&lt;x.max&amp;&amp;(x===f&amp;&amp;y&gt;=x.max/<span class=\"number\">2</span>&amp;&amp;(i.x-=<span class=\"number\">0.03</span>*B,i.y-=<span class=\"number\">0.03</span>*z),A=(x.max-y)/x.max,e.beginPath(),e.lineWidth=A/<span class=\"number\">2</span>,e.strokeStyle=<span class=\"string\">\"rgba(\"</span>+s.c+<span class=\"string\">\",\"</span>+(A+<span class=\"number\">0.2</span>)+<span class=\"string\">\")\"</span>,e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.stroke())&#125;&#125;w.splice(w.indexOf(i),<span class=\"number\">1</span>)&#125;),m(b)&#125;<span class=\"keyword\">var</span> u=<span class=\"built_in\">document</span>.createElement(<span class=\"string\">\"canvas\"</span>),s=l(),c=<span class=\"string\">\"c_n\"</span>+s.l,e=u.getContext(<span class=\"string\">\"2d\"</span>),r,n,m=<span class=\"built_in\">window</span>.requestAnimationFrame||<span class=\"built_in\">window</span>.webkitRequestAnimationFrame||<span class=\"built_in\">window</span>.mozRequestAnimationFrame||<span class=\"built_in\">window</span>.oRequestAnimationFrame||<span class=\"built_in\">window</span>.msRequestAnimationFrame||<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">i</span>)</span>&#123;<span class=\"built_in\">window</span>.setTimeout(i,<span class=\"number\">1000</span>/<span class=\"number\">45</span>)&#125;,a=<span class=\"built_in\">Math</span>.random,f=&#123;<span class=\"attr\">x</span>:<span class=\"literal\">null</span>,<span class=\"attr\">y</span>:<span class=\"literal\">null</span>,<span class=\"attr\">max</span>:<span class=\"number\">20000</span>&#125;;u.id=c;u.style.cssText=<span class=\"string\">\"position:fixed;top:0;left:0;z-index:\"</span>+s.z+<span class=\"string\">\";opacity:\"</span>+s.o;j(<span class=\"string\">\"body\"</span>)[<span class=\"number\">0</span>].appendChild(u);k(),<span class=\"built_in\">window</span>.onresize=k;<span class=\"built_in\">window</span>.onmousemove=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">i</span>)</span>&#123;i=i||<span class=\"built_in\">window</span>.event,f.x=i.clientX,f.y=i.clientY&#125;,<span class=\"built_in\">window</span>.onmouseout=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;f.x=<span class=\"literal\">null</span>,f.y=<span class=\"literal\">null</span>&#125;;<span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> t=[],p=<span class=\"number\">0</span>;s.n&gt;p;p++)&#123;<span class=\"keyword\">var</span> h=a()*r,g=a()*n,q=<span class=\"number\">2</span>*a()<span class=\"number\">-1</span>,d=<span class=\"number\">2</span>*a()<span class=\"number\">-1</span>;t.push(&#123;<span class=\"attr\">x</span>:h,<span class=\"attr\">y</span>:g,<span class=\"attr\">xa</span>:q,<span class=\"attr\">ya</span>:d,<span class=\"attr\">max</span>:<span class=\"number\">6000</span>&#125;)&#125;setTimeout(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;b()&#125;,<span class=\"number\">100</span>)&#125;();%                                                                                                    zhangzw@MacBook-Pro  /data/github/blog   master ● </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9-添加评论功能\"><a href=\"#9-添加评论功能\" class=\"headerlink\" title=\"9. 添加评论功能\"></a>9. 添加评论功能</h3><ul>\n<li><p>9.1 注册leancloud</p>\n<figure class=\"highlight clean\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">注册-&gt; 验证邮箱-&gt; 实名认证 -&gt; 设置获取appid和appkey</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>9.2 修改配置文件</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">valine</span>:</span><br><span class=\"line\">  <span class=\"attribute\">enable</span>: true </span><br><span class=\"line\">  <span class=\"attribute\">appid</span>: <span class=\"string\">'appid'</span> </span><br><span class=\"line\">  <span class=\"attribute\">appkey</span>: <span class=\"string\">'appkey'</span> </span><br><span class=\"line\">  <span class=\"attribute\">placeholder</span>: <span class=\"string\">\"ヾﾉ≧∀≦)o 来呀！快活呀！~啦啦啦~ 啦啦啦啦~\"</span> </span><br><span class=\"line\">  <span class=\"attribute\">visitor</span>: true <span class=\"comment\">//这个打开页会统计文章阅读数</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"10-next6添加字数统计-和阅读时长\"><a href=\"#10-next6添加字数统计-和阅读时长\" class=\"headerlink\" title=\"10. next6添加字数统计 和阅读时长\"></a>10. next6添加字数统计 和阅读时长</h3><blockquote>\n<p><a href=\"https://github.com/theme-next/hexo-symbols-count-time\" target=\"_blank\" rel=\"noopener\">hexo-symbols-count-time</a></p>\n</blockquote>\n<ul>\n<li><p>10.1 安装node扩展</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-symbols-<span class=\"keyword\">count</span>-<span class=\"built_in\">time</span> <span class=\"comment\">--save</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>10.2 修改全局配置 _config.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"><span class=\"attr\">  symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_symbols:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  total_time:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  exclude_codeblock:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>10.3 修改主题配置 _config.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">symbols_count_time:</span></span><br><span class=\"line\"><span class=\"attr\">  separated_meta:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  item_text_post:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  item_text_total:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  awl:</span> <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"attr\">  wpm:</span> <span class=\"number\">275</span></span><br><span class=\"line\"><span class=\"attr\">  suffix:</span> <span class=\"string\">mins.</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"11-next6-文章置顶功能\"><a href=\"#11-next6-文章置顶功能\" class=\"headerlink\" title=\"11. next6 文章置顶功能\"></a>11. next6 文章置顶功能</h3><ul>\n<li><p>11.1 安装node扩展 </p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm <span class=\"keyword\">uninstall</span> hexo-generator-<span class=\"keyword\">index</span> <span class=\"comment\">--save</span></span><br><span class=\"line\">npm <span class=\"keyword\">install</span> hexo-generator-<span class=\"keyword\">index</span>-pin-top <span class=\"comment\">--save</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>11.2 在文章开头添加置顶标识</p>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">top:</span> <span class=\"number\">10</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>11.3 首页添加明显置顶标识</p>\n<figure class=\"highlight django\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\">themes/next/layout/_macro/post.swig 在<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta\"</span>&gt;</span> 下添加如下代码</span></span><br><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">if</span></span> post.top %&#125;</span><span class=\"xml\"></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-thumb-tack\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">font</span> <span class=\"attr\">color</span>=<span class=\"string\">green</span>&gt;</span>置顶<span class=\"tag\">&lt;/<span class=\"name\">font</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-divider\"</span>&gt;</span>|<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">endif</span></span> %&#125;</span><span class=\"xml\"></span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"12-next6-开启标签和分类\"><a href=\"#12-next6-开启标签和分类\" class=\"headerlink\" title=\"12. next6 开启标签和分类\"></a>12. next6 开启标签和分类</h3><ul>\n<li><p>12.1 创建tags相关目录</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new<span class=\"built_in\"> page </span>tags</span><br><span class=\"line\">hexo new<span class=\"built_in\"> page </span>categories</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.2 开启tags标签和分类</p>\n<figure class=\"highlight subunit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim themes/next/_config.yml</span><br><span class=\"line\"><span class=\"keyword\">tags:</span> /tags/ || tags</span><br><span class=\"line\">categories: /categories/ || th</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.3 修改tags站点文件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cat</span> <span class=\"string\">source/tags/index.md</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">tags</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">2019</span><span class=\"bullet\">-09</span><span class=\"bullet\">-24</span> <span class=\"number\">10</span><span class=\"string\">:08:59</span></span><br><span class=\"line\"><span class=\"attr\">type:</span> <span class=\"string\">\"tags\"</span></span><br><span class=\"line\"><span class=\"attr\">layout:</span> <span class=\"string\">\"tags\"</span></span><br><span class=\"line\"><span class=\"attr\">comments:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.4 修改categories站点文件</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cat</span> <span class=\"string\">source/categories/index.md</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">categories</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">2019</span><span class=\"bullet\">-09</span><span class=\"bullet\">-24</span> <span class=\"number\">10</span><span class=\"string\">:09:55</span></span><br><span class=\"line\"><span class=\"attr\">type:</span> <span class=\"string\">\"categories\"</span></span><br><span class=\"line\"><span class=\"attr\">layout:</span> <span class=\"string\">\"categories\"</span></span><br><span class=\"line\"><span class=\"attr\">comments:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>12.5 去掉xxx.github.io/tags/ 页面的post-title(因为我的这个css左对齐了,默认是居中,所以很丑)</p>\n<figure class=\"highlight django\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"># 注释下面这段代码</span></span><br><span class=\"line\"><span class=\"xml\">vim themes/nextv/layout/page.swig </span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"comment\">&lt;!-- </span></span><span class=\"template-tag\">&#123;% <span class=\"name\"><span class=\"name\">include</span></span> '_partials/page/page-header.swig' %&#125;</span><span class=\"xml\"><span class=\"comment\"> --&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>"}],"PostAsset":[],"PostCategory":[{"post_id":"ck0x8fsrb00007g9kl1wrzdcu","category_id":"ck0x8fsrq00037g9kacshh95g","_id":"ck0x8fsru00077g9kvo7g85qg"},{"post_id":"ck0x8fsrb00007g9kl1wrzdcu","category_id":"ck0x8fsrt00067g9k8y85f9dv","_id":"ck0x8fsru00087g9k9qklc3zd"},{"post_id":"ck0x8fst000097g9k74o6emtx","category_id":"ck0x8fsrq00037g9kacshh95g","_id":"ck0x8fst6000f7g9kwa9e8iih"},{"post_id":"ck0x8fst000097g9k74o6emtx","category_id":"ck0x8fst5000c7g9kvyfzbq25","_id":"ck0x8fst7000i7g9kw7lykiiv"},{"post_id":"ck0x8fst3000a7g9ko6hobcsz","category_id":"ck0x8fsrq00037g9kacshh95g","_id":"ck0x8fst7000k7g9k468myafz"},{"post_id":"ck0x8fst3000a7g9ko6hobcsz","category_id":"ck0x8fst6000e7g9kz756trhm","_id":"ck0x8fst7000n7g9kd10yz1jq"}],"PostTag":[{"post_id":"ck0x8fsrb00007g9kl1wrzdcu","tag_id":"ck0x8fsrr00047g9k4r81tzew","_id":"ck0x8fsrt00057g9k84z93inu"},{"post_id":"ck0x8fst000097g9k74o6emtx","tag_id":"ck0x8fsrr00047g9k4r81tzew","_id":"ck0x8fst6000h7g9kwhoe5poa"},{"post_id":"ck0x8fst000097g9k74o6emtx","tag_id":"ck0x8fst5000b7g9ke6lzbyxp","_id":"ck0x8fst7000j7g9kdl8es90g"},{"post_id":"ck0x8fst000097g9k74o6emtx","tag_id":"ck0x8fst6000d7g9k69mxkhg3","_id":"ck0x8fst7000m7g9kkl33tos6"},{"post_id":"ck0x8fst3000a7g9ko6hobcsz","tag_id":"ck0x8fst6000g7g9ky6o1vi22","_id":"ck0x8fst7000o7g9kygvayytn"},{"post_id":"ck0x8fst3000a7g9ko6hobcsz","tag_id":"ck0x8fst7000l7g9ky5j7drjx","_id":"ck0x8fst7000p7g9ko0gsigas"}],"Tag":[{"name":"k8s","_id":"ck0x8fsrr00047g9k4r81tzew"},{"name":"elk","_id":"ck0x8fst5000b7g9ke6lzbyxp"},{"name":"elk7","_id":"ck0x8fst6000d7g9k69mxkhg3"},{"name":"hexo6","_id":"ck0x8fst6000g7g9ky6o1vi22"},{"name":"hexo美化","_id":"ck0x8fst7000l7g9ky5j7drjx"}]}}